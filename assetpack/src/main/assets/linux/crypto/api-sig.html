<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Asymmetric Signature Algorithm Definitions &#8212; The Linux Kernel  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=a152c8ac" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Key-agreement Protocol Primitives (KPP) Cipher Algorithm Definitions" href="api-kpp.html" />
    <link rel="prev" title="Asymmetric Cipher Algorithm Definitions" href="api-akcipher.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.16.0</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><!-- SPDX-License-Identifier: GPL-2.0 -->

<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../subsystem-apis.html">Subsystems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#core-subsystems">Core subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#human-interfaces">Human interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#networking-interfaces">Networking interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#storage-interfaces">Storage interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../subsystem-apis.html#other-subsystems">Other subsystems</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpu-freq/index.html">CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../edac/index.html">EDAC Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fpga/index.html">FPGA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pcmcia/index.html">PCMCIA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../watchdog/index.html">Watchdog Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../virt/index.html">Virtualization Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hwmon/index.html">Hardware Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accel/index.html">Compute Accelerators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Crypto API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PCI/index.html">PCI Bus Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peci/index.html">PECI Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wmi/index.html">WMI Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tee/index.html">TEE Subsystem</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">Userspace API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/crypto/api-sig.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <!-- SPDX-License-Identifier: GPL-2.0 -->
<!-- Copyright © 2023, Oracle and/or its affiliates. -->


<section id="asymmetric-signature-algorithm-definitions">
<h1>Asymmetric Signature Algorithm Definitions<a class="headerlink" href="#asymmetric-signature-algorithm-definitions" title="Link to this heading">¶</a></h1>
<dl class="c struct">
<dt class="sig sig-object c" id="c.sig_alg">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sig_alg</span></span></span><a class="headerlink" href="#c.sig_alg" title="Link to this definition">¶</a><br /></dt>
<dd><p>generic public key signature algorithm</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct sig_alg {
    int (*sign)(struct crypto_sig *tfm,const void *src, unsigned int slen, void *dst, unsigned int dlen);
    int (*verify)(struct crypto_sig *tfm,const void *src, unsigned int slen, const void *digest, unsigned int dlen);
    int (*set_pub_key)(struct crypto_sig *tfm, const void *key, unsigned int keylen);
    int (*set_priv_key)(struct crypto_sig *tfm, const void *key, unsigned int keylen);
    unsigned int (*key_size)(struct crypto_sig *tfm);
    unsigned int (*digest_size)(struct crypto_sig *tfm);
    unsigned int (*max_size)(struct crypto_sig *tfm);
    int (*init)(struct crypto_sig *tfm);
    void (*exit)(struct crypto_sig *tfm);
    struct crypto_alg base;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sign</span></code></dt><dd><p>Function performs a sign operation as defined by public key
algorithm. On success, the signature size is returned.
Optional.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">verify</span></code></dt><dd><p>Function performs a complete verify operation as defined by
public key algorithm, returning verification status. Optional.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">set_pub_key</span></code></dt><dd><p>Function invokes the algorithm specific set public key
function, which knows how to decode and interpret
the BER encoded public key and parameters. Mandatory.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">set_priv_key</span></code></dt><dd><p>Function invokes the algorithm specific set private key
function, which knows how to decode and interpret
the BER encoded private key and parameters. Optional.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">key_size</span></code></dt><dd><p>Function returns key size. Mandatory.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">digest_size</span></code></dt><dd><p>Function returns maximum digest size. Optional.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">max_size</span></code></dt><dd><p>Function returns maximum signature size. Optional.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">init</span></code></dt><dd><p>Initialize the cryptographic transformation object.
This function is used to initialize the cryptographic
transformation object. This function is called only once at
the instantiation time, right after the transformation context
was allocated. In case the cryptographic hardware has some
special requirements which need to be handled by software, this
function shall check for the precise requirement of the
transformation and put any software fallbacks in place.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">exit</span></code></dt><dd><p>Deinitialize the cryptographic transformation object. This is a
counterpart to <strong>init</strong>, used to remove various changes set in
<strong>init</strong>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">base</span></code></dt><dd><p>Common crypto API algorithm data structure</p>
</dd>
</dl>
</div>
</section>
<section id="asymmetric-signature-api">
<h1>Asymmetric Signature API<a class="headerlink" href="#asymmetric-signature-api" title="Link to this heading">¶</a></h1>
<p>The Public Key Signature API is used with the algorithms of type
CRYPTO_ALG_TYPE_SIG (listed as type “sig” in /proc/crypto)</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_alloc_sig">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">crypto_alloc_sig</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">alg_name</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">mask</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_alloc_sig" title="Link to this definition">¶</a><br /></dt>
<dd><p>allocate signature tfm handle</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*alg_name</span></code></dt><dd><p>is the cra_name / name or cra_driver_name / driver name of the
signing algorithm e.g. “ecdsa”</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">type</span></code></dt><dd><p>specifies the type of the algorithm</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">mask</span></code></dt><dd><p>specifies the mask for the algorithm</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Allocate a handle for public key signature algorithm. The returned struct
crypto_sig is the handle that is required for any subsequent
API invocation for signature operations.</p>
<p><strong>Return</strong></p>
<dl class="simple">
<dt>allocated handle in case of success; IS_ERR() is true in case</dt><dd><p>of an error, <a class="reference internal" href="../core-api/kernel-api.html#c.PTR_ERR" title="PTR_ERR"><code class="xref c c-func docutils literal notranslate"><span class="pre">PTR_ERR()</span></code></a> returns the error code.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_free_sig">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_free_sig</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tfm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_free_sig" title="Link to this definition">¶</a><br /></dt>
<dd><p>free signature tfm handle</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_sig</span> <span class="pre">*tfm</span></code></dt><dd><p>signature tfm handle allocated with <a class="reference internal" href="#c.crypto_alloc_sig" title="crypto_alloc_sig"><code class="xref c c-func docutils literal notranslate"><span class="pre">crypto_alloc_sig()</span></code></a></p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>If <strong>tfm</strong> is a NULL or error pointer, this function does nothing.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_sig_keysize">
<span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_sig_keysize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tfm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_sig_keysize" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get key size</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_sig</span> <span class="pre">*tfm</span></code></dt><dd><p>signature tfm handle allocated with <a class="reference internal" href="#c.crypto_alloc_sig" title="crypto_alloc_sig"><code class="xref c c-func docutils literal notranslate"><span class="pre">crypto_alloc_sig()</span></code></a></p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Function returns the key size in bits.
Function assumes that the key is already set in the transformation. If this
function is called without a setkey or with a failed setkey, you may end up
in a NULL dereference.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_sig_digestsize">
<span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_sig_digestsize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tfm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_sig_digestsize" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get maximum digest size</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_sig</span> <span class="pre">*tfm</span></code></dt><dd><p>signature tfm handle allocated with <a class="reference internal" href="#c.crypto_alloc_sig" title="crypto_alloc_sig"><code class="xref c c-func docutils literal notranslate"><span class="pre">crypto_alloc_sig()</span></code></a></p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Function returns the maximum digest size in bytes.
Function assumes that the key is already set in the transformation. If this
function is called without a setkey or with a failed setkey, you may end up
in a NULL dereference.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_sig_maxsize">
<span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_sig_maxsize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tfm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_sig_maxsize" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get maximum signature size</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_sig</span> <span class="pre">*tfm</span></code></dt><dd><p>signature tfm handle allocated with <a class="reference internal" href="#c.crypto_alloc_sig" title="crypto_alloc_sig"><code class="xref c c-func docutils literal notranslate"><span class="pre">crypto_alloc_sig()</span></code></a></p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Function returns the maximum signature size in bytes.
Function assumes that the key is already set in the transformation. If this
function is called without a setkey or with a failed setkey, you may end up
in a NULL dereference.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_sig_sign">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_sig_sign</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tfm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">src</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">slen</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dst</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">dlen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_sig_sign" title="Link to this definition">¶</a><br /></dt>
<dd><p>Invoke signing operation</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_sig</span> <span class="pre">*tfm</span></code></dt><dd><p>signature tfm handle allocated with <a class="reference internal" href="#c.crypto_alloc_sig" title="crypto_alloc_sig"><code class="xref c c-func docutils literal notranslate"><span class="pre">crypto_alloc_sig()</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">void</span> <span class="pre">*src</span></code></dt><dd><p>source buffer</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">slen</span></code></dt><dd><p>source length</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*dst</span></code></dt><dd><p>destination obuffer</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">dlen</span></code></dt><dd><p>destination length</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Function invokes the specific signing operation for a given algorithm</p>
<p><strong>Return</strong></p>
<p>signature size on success; error code in case of error</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_sig_verify">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_sig_verify</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tfm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">src</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">slen</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">digest</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">dlen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_sig_verify" title="Link to this definition">¶</a><br /></dt>
<dd><p>Invoke signature verification</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_sig</span> <span class="pre">*tfm</span></code></dt><dd><p>signature tfm handle allocated with <a class="reference internal" href="#c.crypto_alloc_sig" title="crypto_alloc_sig"><code class="xref c c-func docutils literal notranslate"><span class="pre">crypto_alloc_sig()</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">void</span> <span class="pre">*src</span></code></dt><dd><p>source buffer</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">slen</span></code></dt><dd><p>source length</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">void</span> <span class="pre">*digest</span></code></dt><dd><p>digest</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">dlen</span></code></dt><dd><p>digest length</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Function invokes the specific signature verification operation
for a given algorithm.</p>
<p><strong>Return</strong></p>
<p>zero on verification success; error code in case of error.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_sig_set_pubkey">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_sig_set_pubkey</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tfm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">keylen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_sig_set_pubkey" title="Link to this definition">¶</a><br /></dt>
<dd><p>Invoke set public key operation</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_sig</span> <span class="pre">*tfm</span></code></dt><dd><p>tfm handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">void</span> <span class="pre">*key</span></code></dt><dd><p>BER encoded public key, algo OID, paramlen, BER encoded
parameters</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">keylen</span></code></dt><dd><p>length of the key (not including other data)</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Function invokes the algorithm specific set key function, which knows
how to decode and interpret the encoded key and parameters</p>
<p><strong>Return</strong></p>
<p>zero on success; error code in case of error</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.crypto_sig_set_privkey">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_sig_set_privkey</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">crypto_sig</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tfm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">keylen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_sig_set_privkey" title="Link to this definition">¶</a><br /></dt>
<dd><p>Invoke set private key operation</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">crypto_sig</span> <span class="pre">*tfm</span></code></dt><dd><p>tfm handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">void</span> <span class="pre">*key</span></code></dt><dd><p>BER encoded private key, algo OID, paramlen, BER encoded
parameters</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">keylen</span></code></dt><dd><p>length of the key (not including other data)</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Function invokes the algorithm specific set key function, which knows
how to decode and interpret the encoded key and parameters</p>
<p><strong>Return</strong></p>
<p>zero on success; error code in case of error</p>
</div>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/crypto/api-sig.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>