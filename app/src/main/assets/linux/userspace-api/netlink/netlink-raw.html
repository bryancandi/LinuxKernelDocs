
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Netlink specification support for raw Netlink families &#8212; The Linux Kernel  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Platform Profile Selection (e.g. /sys/firmware/acpi/platform_profile)" href="../sysfs-platform_profile.html" />
    <link rel="prev" title="Netlink specification support for legacy Generic Netlink families" href="genetlink-legacy.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.8.0</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><!-- SPDX-License-Identifier: GPL-2.0 -->

<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/development-process.html">A guide to the Kernel Development Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/submitting-patches.html">Submitting patches: the essential guide to getting your code into the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">All development-process docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">Driver implementer's API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subsystem-apis.html">Kernel subsystem documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">Locking in the kernel</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Linux kernel licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/testing-overview.html">Kernel Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Kernel Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rust/index.html">Rust</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">The Linux kernel user's and administrator's guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">The kernel build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">User-space tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The Linux kernel user-space API guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../no_new_privs.html">No New Privileges Flag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seccomp_filter.html">Seccomp BPF (SECure COMPuting with filters)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../landlock.html">Landlock: unprivileged access control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unshare.html">unshare system call</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_ctrl.html">Speculation Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accelerators/ocxl.html">OpenCAPI (Open Coherent Accelerator Processor Interface)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dma-buf-alloc-exchange.html">Exchanging pixel buffers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ebpf/index.html">eBPF Userspace API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ELF.html">Linux-specific ELF idiosyncrasies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ioctl/index.html">IOCTLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iommu.html">IOMMU Userspace API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iommufd.html">IOMMUFD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../media/index.html">Linux Media Infrastructure userspace API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Netlink Handbook</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro.html">Introduction to Netlink</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro-specs.html">Using Netlink protocol specifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="specs.html">Netlink protocol specifications (in YAML)</a></li>
<li class="toctree-l3"><a class="reference internal" href="c-code-gen.html">Netlink spec C code generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="genetlink-legacy.html">Netlink specification support for legacy Generic Netlink families</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Netlink specification support for raw Netlink families</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sysfs-platform_profile.html">Platform Profile Selection (e.g. /sys/firmware/acpi/platform_profile)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vduse.html">VDUSE - &quot;vDPA Device in Userspace&quot;</a></li>
<li class="toctree-l2"><a class="reference internal" href="../futex2.html">futex2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lsm.html">Linux Security Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tee.html">TEE (Trusted Execution Environment) Userspace API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../isapnp.html">ISA Plug &amp; Play support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dcdbas.html">Dell Systems Management Base Driver</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">Unsorted Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RAS/ras.html">Reliability, Availability and Serviceability features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/userspace-api/netlink/netlink-raw.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <!-- SPDX-License-Identifier: GPL-2.0 -->
<!-- Copyright © 2023, Oracle and/or its affiliates. -->


<section id="netlink-specification-support-for-raw-netlink-families">
<h1>Netlink specification support for raw Netlink families<a class="headerlink" href="#netlink-specification-support-for-raw-netlink-families" title="Permalink to this heading">¶</a></h1>
<p>This document describes the additional properties required by raw Netlink
families such as <code class="docutils literal notranslate"><span class="pre">NETLINK_ROUTE</span></code> which use the <code class="docutils literal notranslate"><span class="pre">netlink-raw</span></code> protocol
specification.</p>
<section id="specification">
<h2>Specification<a class="headerlink" href="#specification" title="Permalink to this heading">¶</a></h2>
<p>The netlink-raw schema extends the <a class="reference internal" href="genetlink-legacy.html"><span class="doc">genetlink-legacy</span></a>
schema with properties that are needed to specify the protocol numbers and
multicast IDs used by raw netlink families. See <a class="reference internal" href="intro.html#classic-netlink"><span class="std std-ref">Classic Netlink</span></a> for more
information. The raw netlink families also make use of type-specific
sub-messages.</p>
<section id="globals">
<h3>Globals<a class="headerlink" href="#globals" title="Permalink to this heading">¶</a></h3>
<section id="protonum">
<h4>protonum<a class="headerlink" href="#protonum" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">protonum</span></code> property is used to specify the protocol number to use when
opening a netlink socket.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># SPDX-License-Identifier: ((GPL-2.0 WITH Linux-syscall-note) OR BSD-3-Clause)</span>

<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rt-addr</span>
<span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">netlink-raw</span>
<span class="nt">protonum</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">             </span><span class="c1"># part of the NETLINK_ROUTE protocol</span>
</pre></div>
</div>
</section>
</section>
<section id="multicast-group-properties">
<h3>Multicast group properties<a class="headerlink" href="#multicast-group-properties" title="Permalink to this heading">¶</a></h3>
<section id="value">
<h4>value<a class="headerlink" href="#value" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> property is used to specify the group ID to use for multicast
group registration.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">mcast-groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">list</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rtnlgrp-ipv4-ifaddr</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rtnlgrp-ipv6-ifaddr</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rtnlgrp-mctp-ifaddr</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">34</span>
</pre></div>
</div>
</section>
</section>
<section id="sub-messages">
<h3>Sub-messages<a class="headerlink" href="#sub-messages" title="Permalink to this heading">¶</a></h3>
<p>Several raw netlink families such as
<a class="reference internal" href="../../networking/netlink_spec/rt_link.html"><span class="doc">rt_link</span></a> and
<a class="reference internal" href="../../networking/netlink_spec/tc.html"><span class="doc">tc</span></a> use attribute nesting as an
abstraction to carry module specific information.</p>
<p>Conceptually it looks as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[OUTER NEST OR MESSAGE LEVEL]
  [GENERIC ATTR 1]
  [GENERIC ATTR 2]
  [GENERIC ATTR 3]
  [GENERIC ATTR - wrapper]
    [MODULE SPECIFIC ATTR 1]
    [MODULE SPECIFIC ATTR 2]
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">GENERIC</span> <span class="pre">ATTRs</span></code> at the outer level are defined in the core (or rt_link or
core TC), while specific drivers, TC classifiers, qdiscs etc. can carry their
own information wrapped in the <code class="docutils literal notranslate"><span class="pre">GENERIC</span> <span class="pre">ATTR</span> <span class="pre">-</span> <span class="pre">wrapper</span></code>. Even though the
example above shows attributes nesting inside the wrapper, the modules generally
have full freedom to define the format of the nest. In practice the payload of
the wrapper attr has very similar characteristics to a netlink message. It may
contain a fixed header / structure, netlink attributes, or both. Because of
those shared characteristics we refer to the payload of the wrapper attribute as
a sub-message.</p>
<p>A sub-message attribute uses the value of another attribute as a selector key to
choose the right sub-message format. For example if the following attribute has
already been decoded:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gre&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>and we encounter the following attribute spec:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sub-message</span>
<span class="w">  </span><span class="nt">sub-message</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linkinfo-data-msg</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kind</span>
</pre></div>
</div>
<p>Then we look for a sub-message definition called <code class="docutils literal notranslate"><span class="pre">linkinfo-data-msg</span></code> and use
the value of the <code class="docutils literal notranslate"><span class="pre">kind</span></code> attribute i.e. <code class="docutils literal notranslate"><span class="pre">gre</span></code> as the key to choose the
correct format for the sub-message:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">sub-messages</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linkinfo-data-msg</span>
<span class="w">  </span><span class="nt">formats</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge</span>
<span class="w">      </span><span class="nt">attribute-set</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linkinfo-bridge-attrs</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gre</span>
<span class="w">      </span><span class="nt">attribute-set</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linkinfo-gre-attrs</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">geneve</span>
<span class="w">      </span><span class="nt">attribute-set</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linkinfo-geneve-attrs</span>
</pre></div>
</div>
<p>This would decode the attribute value as a sub-message with the attribute-set
called <code class="docutils literal notranslate"><span class="pre">linkinfo-gre-attrs</span></code> as the attribute space.</p>
<p>A sub-message can have an optional <code class="docutils literal notranslate"><span class="pre">fixed-header</span></code> followed by zero or more
attributes from an <code class="docutils literal notranslate"><span class="pre">attribute-set</span></code>. For example the following
<code class="docutils literal notranslate"><span class="pre">tc-options-msg</span></code> sub-message defines message formats that use a mixture of
<code class="docutils literal notranslate"><span class="pre">fixed-header</span></code>, <code class="docutils literal notranslate"><span class="pre">attribute-set</span></code> or both together:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">sub-messages</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tc-options-msg</span>
<span class="w">    </span><span class="nt">formats</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bfifo</span>
<span class="w">        </span><span class="nt">fixed-header</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tc-fifo-qopt</span>
<span class="w">      </span><span class="p p-Indicator">-</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cake</span>
<span class="w">        </span><span class="nt">attribute-set</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tc-cake-attrs</span>
<span class="w">      </span><span class="p p-Indicator">-</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">netem</span>
<span class="w">        </span><span class="nt">fixed-header</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tc-netem-qopt</span>
<span class="w">        </span><span class="nt">attribute-set</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tc-netem-attrs</span>
</pre></div>
</div>
<p>Note that a selector attribute must appear in a netlink message before any
sub-message attributes that depend on it.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/userspace-api/netlink/netlink-raw.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>