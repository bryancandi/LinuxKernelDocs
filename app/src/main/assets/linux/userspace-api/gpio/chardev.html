<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GPIO Character Device Userspace API &#8212; The Linux Kernel  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=a152c8ac" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="GPIO_V2_GET_LINE_IOCTL" href="gpio-v2-get-line-ioctl.html" />
    <link rel="prev" title="GPIO" href="../../admin-guide/gpio/index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.13.0</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><!-- SPDX-License-Identifier: GPL-2.0 -->

<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">All development-process docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subsystem-apis.html">Subsystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rust/index.html">Rust</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Userspace API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#system-calls">System calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#security-related-interfaces">Security-related interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#devices-and-i-o">Devices and I/O</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../accelerators/ocxl.html">OpenCAPI (Open Coherent Accelerator Processor Interface)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dma-buf-alloc-exchange.html">Exchanging pixel buffers</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">GPIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iommufd.html">IOMMUFD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../media/index.html">Linux Media Infrastructure userspace API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dcdbas.html">Dell Systems Management Base Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vduse.html">VDUSE - “vDPA Device in Userspace”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../isapnp.html">ISA Plug &amp; Play support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#everything-else">Everything else</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">Unsorted documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/userspace-api/gpio/chardev.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <!-- SPDX-License-Identifier: GPL-2.0 -->
<!-- Copyright © 2023, Oracle and/or its affiliates. -->


<section id="gpio-character-device-userspace-api">
<h1>GPIO Character Device Userspace API<a class="headerlink" href="#gpio-character-device-userspace-api" title="Link to this heading">¶</a></h1>
<p>This is latest version (v2) of the character device API, as defined in
<code class="docutils literal notranslate"><span class="pre">include/uapi/linux/gpio.h.</span></code></p>
<p>First added in 5.10.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do NOT abuse userspace APIs to control hardware that has proper kernel
drivers. There may already be a driver for your use case, and an existing
kernel driver is sure to provide a superior solution to bitbashing
from userspace.</p>
<p>Read <a class="reference internal" href="../../driver-api/gpio/drivers-on-gpio.html"><span class="doc">Subsystem drivers using GPIO</span></a> to avoid reinventing
kernel wheels in userspace.</p>
<p>Similarly, for multi-function lines there may be other subsystems, such as
<a class="reference internal" href="../../spi/index.html"><span class="doc">Serial Peripheral Interface (SPI)</span></a>, <a class="reference internal" href="../../i2c/index.html"><span class="doc">I2C/SMBus Subsystem</span></a>,
<a class="reference internal" href="../../driver-api/pwm.html"><span class="doc">Pulse Width Modulation (PWM) interface</span></a>, <a class="reference internal" href="../../w1/index.html"><span class="doc">1-Wire Subsystem</span></a> etc, that
provide suitable drivers and APIs for your hardware.</p>
</div>
<p>Basic examples using the character device API can be found in <code class="docutils literal notranslate"><span class="pre">tools/gpio/*</span></code>.</p>
<p>The API is based around two major objects, the <a class="reference internal" href="#gpio-v2-chip"><span class="std std-ref">Chip</span></a> and the
<a class="reference internal" href="#gpio-v2-line-request"><span class="std std-ref">Line Request</span></a>.</p>
<section id="chip">
<span id="gpio-v2-chip"></span><h2>Chip<a class="headerlink" href="#chip" title="Link to this heading">¶</a></h2>
<p>The Chip represents a single GPIO chip and is exposed to userspace using device
files of the form <code class="docutils literal notranslate"><span class="pre">/dev/gpiochipX</span></code>.</p>
<p>Each chip supports a number of GPIO lines,
<a class="reference internal" href="#c.gpiochip_info" title="gpiochip_info"><code class="xref c c-type docutils literal notranslate"><span class="pre">chip.lines</span></code></a>. Lines on the chip are identified by an
<code class="docutils literal notranslate"><span class="pre">offset</span></code> in the range from 0 to <code class="docutils literal notranslate"><span class="pre">chip.lines</span> <span class="pre">-</span> <span class="pre">1</span></code>, i.e. <cite>[0,chip.lines)</cite>.</p>
<p>Lines are requested from the chip using <a class="reference internal" href="gpio-v2-get-line-ioctl.html"><span class="doc">GPIO_V2_GET_LINE_IOCTL</span></a>
and the resulting line request is used to access the GPIO chip’s lines or
monitor the lines for edge events.</p>
<p>Within this documentation, the file descriptor returned by calling <cite>open()</cite>
on the GPIO device file is referred to as <code class="docutils literal notranslate"><span class="pre">chip_fd</span></code>.</p>
<section id="operations">
<h3>Operations<a class="headerlink" href="#operations" title="Link to this heading">¶</a></h3>
<p>The following operations may be performed on the chip:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="gpio-v2-get-line-ioctl.html">Get Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio-get-chipinfo-ioctl.html">Get Chip Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio-v2-get-lineinfo-ioctl.html">Get Line Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio-v2-get-lineinfo-watch-ioctl.html">Watch Line Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio-get-lineinfo-unwatch-ioctl.html">Unwatch Line Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio-v2-lineinfo-changed-read.html">Read Line Info Changed Events</a></li>
</ul>
</div>
</section>
</section>
<section id="line-request">
<span id="gpio-v2-line-request"></span><h2>Line Request<a class="headerlink" href="#line-request" title="Link to this heading">¶</a></h2>
<p>Line requests are created by <a class="reference internal" href="gpio-v2-get-line-ioctl.html"><span class="doc">GPIO_V2_GET_LINE_IOCTL</span></a> and provide
access to a set of requested lines.  The line request is exposed to userspace
via the anonymous file descriptor returned in
<a class="reference internal" href="#c.gpio_v2_line_request" title="gpio_v2_line_request"><code class="xref c c-type docutils literal notranslate"><span class="pre">request.fd</span></code></a> by <a class="reference internal" href="gpio-v2-get-line-ioctl.html"><span class="doc">GPIO_V2_GET_LINE_IOCTL</span></a>.</p>
<p>Within this documentation, the line request file descriptor is referred to
as <code class="docutils literal notranslate"><span class="pre">req_fd</span></code>.</p>
<section id="id1">
<h3>Operations<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>The following operations may be performed on the line request:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="gpio-v2-line-get-values-ioctl.html">Get Line Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio-v2-line-set-values-ioctl.html">Set Line Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio-v2-line-event-read.html">Read Line Edge Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio-v2-line-set-config-ioctl.html">Reconfigure Lines</a></li>
</ul>
</div>
</section>
</section>
<section id="types">
<h2>Types<a class="headerlink" href="#types" title="Link to this heading">¶</a></h2>
<p>This section contains the structs and enums that are referenced by the API v2,
as defined in <code class="docutils literal notranslate"><span class="pre">include/uapi/linux/gpio.h</span></code>.</p>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpiochip_info">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpiochip_info</span></span></span><a class="headerlink" href="#c.gpiochip_info" title="Link to this definition">¶</a><br /></dt>
<dd><p>Information about a certain GPIO chip</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpiochip_info {
    char name[GPIO_MAX_NAME_SIZE];
    char label[GPIO_MAX_NAME_SIZE];
    __u32 lines;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">name</span></code></dt><dd><p>the Linux kernel name of this GPIO chip</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">label</span></code></dt><dd><p>a functional name for this GPIO chip, such as a product
number, may be empty (i.e. label[0] == ‘0’)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">lines</span></code></dt><dd><p>number of GPIO lines on this chip</p>
</dd>
</dl>
</div>
<dl class="c enum">
<dt class="sig sig-object c" id="c.gpio_v2_line_flag">
<span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_flag</span></span></span><a class="headerlink" href="#c.gpio_v2_line_flag" title="Link to this definition">¶</a><br /></dt>
<dd><p><a class="reference internal" href="#c.gpio_v2_line_attribute" title="gpio_v2_line_attribute"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">gpio_v2_line_attribute</span></code></a>.flags values</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_USED</span></code></dt><dd><p>line is not available for request</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_ACTIVE_LOW</span></code></dt><dd><p>line active state is physical low</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_INPUT</span></code></dt><dd><p>line is an input</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_OUTPUT</span></code></dt><dd><p>line is an output</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_EDGE_RISING</span></code></dt><dd><p>line detects rising (inactive to active)
edges</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_EDGE_FALLING</span></code></dt><dd><p>line detects falling (active to
inactive) edges</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_OPEN_DRAIN</span></code></dt><dd><p>line is an open drain output</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_OPEN_SOURCE</span></code></dt><dd><p>line is an open source output</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_BIAS_PULL_UP</span></code></dt><dd><p>line has pull-up bias enabled</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_BIAS_PULL_DOWN</span></code></dt><dd><p>line has pull-down bias enabled</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_BIAS_DISABLED</span></code></dt><dd><p>line has bias disabled</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_EVENT_CLOCK_REALTIME</span></code></dt><dd><p>line events contain REALTIME timestamps</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_EVENT_CLOCK_HTE</span></code></dt><dd><p>line events contain timestamps from
the hardware timestamping engine (HTE) subsystem</p>
</dd>
</dl>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpio_v2_line_values">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_values</span></span></span><a class="headerlink" href="#c.gpio_v2_line_values" title="Link to this definition">¶</a><br /></dt>
<dd><p>Values of GPIO lines</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpio_v2_line_values {
    __aligned_u64 bits;
    __aligned_u64 mask;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">bits</span></code></dt><dd><p>a bitmap containing the value of the lines, set to 1 for active
and 0 for inactive</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">mask</span></code></dt><dd><p>a bitmap identifying the lines to get or set, with each bit
number corresponding to the index into <a class="reference internal" href="#c.gpio_v2_line_request" title="gpio_v2_line_request"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span>
<span class="pre">gpio_v2_line_request</span></code></a>.offsets</p>
</dd>
</dl>
</div>
<dl class="c enum">
<dt class="sig sig-object c" id="c.gpio_v2_line_attr_id">
<span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_attr_id</span></span></span><a class="headerlink" href="#c.gpio_v2_line_attr_id" title="Link to this definition">¶</a><br /></dt>
<dd><p><a class="reference internal" href="#c.gpio_v2_line_attribute" title="gpio_v2_line_attribute"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">gpio_v2_line_attribute</span></code></a>.id values identifying which field of the attribute union is in use.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_ATTR_ID_FLAGS</span></code></dt><dd><p>flags field is in use</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_ATTR_ID_OUTPUT_VALUES</span></code></dt><dd><p>values field is in use</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_ATTR_ID_DEBOUNCE</span></code></dt><dd><p>debounce_period_us field is in use</p>
</dd>
</dl>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpio_v2_line_attribute">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_attribute</span></span></span><a class="headerlink" href="#c.gpio_v2_line_attribute" title="Link to this definition">¶</a><br /></dt>
<dd><p>a configurable attribute of a line</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpio_v2_line_attribute {
    __u32 id;
    __u32 padding;
    union {
        __aligned_u64 flags;
        __aligned_u64 values;
        __u32 debounce_period_us;
    };
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">id</span></code></dt><dd><p>attribute identifier with value from <a class="reference internal" href="#c.gpio_v2_line_attr_id" title="gpio_v2_line_attr_id"><code class="xref c c-type docutils literal notranslate"><span class="pre">enum</span> <span class="pre">gpio_v2_line_attr_id</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">padding</span></code></dt><dd><p>reserved for future use and must be zero filled</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">{unnamed_union}</span></code></dt><dd><p>anonymous</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">flags</span></code></dt><dd><p>if id is <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_ATTR_ID_FLAGS</span></code>, the flags for the GPIO
line, with values from <a class="reference internal" href="#c.gpio_v2_line_flag" title="gpio_v2_line_flag"><code class="xref c c-type docutils literal notranslate"><span class="pre">enum</span> <span class="pre">gpio_v2_line_flag</span></code></a>, such as
<code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_ACTIVE_LOW</span></code>, <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_OUTPUT</span></code> etc, added
together.  This overrides the default flags contained in the <a class="reference internal" href="#c.gpio_v2_line_config" title="gpio_v2_line_config"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span>
<span class="pre">gpio_v2_line_config</span></code></a> for the associated line.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">values</span></code></dt><dd><p>if id is <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_ATTR_ID_OUTPUT_VALUES</span></code>, a bitmap
containing the values to which the lines will be set, with each bit
number corresponding to the index into <a class="reference internal" href="#c.gpio_v2_line_request" title="gpio_v2_line_request"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span>
<span class="pre">gpio_v2_line_request</span></code></a>.offsets</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">debounce_period_us</span></code></dt><dd><p>if id is <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_ATTR_ID_DEBOUNCE</span></code>, the
desired debounce period, in microseconds</p>
</dd>
</dl>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpio_v2_line_config_attribute">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_config_attribute</span></span></span><a class="headerlink" href="#c.gpio_v2_line_config_attribute" title="Link to this definition">¶</a><br /></dt>
<dd><p>a configuration attribute associated with one or more of the requested lines.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpio_v2_line_config_attribute {
    struct gpio_v2_line_attribute attr;
    __aligned_u64 mask;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">attr</span></code></dt><dd><p>the configurable attribute</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">mask</span></code></dt><dd><p>a bitmap identifying the lines to which the attribute applies,
with each bit number corresponding to the index into <a class="reference internal" href="#c.gpio_v2_line_request" title="gpio_v2_line_request"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span>
<span class="pre">gpio_v2_line_request</span></code></a>.offsets</p>
</dd>
</dl>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpio_v2_line_config">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_config</span></span></span><a class="headerlink" href="#c.gpio_v2_line_config" title="Link to this definition">¶</a><br /></dt>
<dd><p>Configuration for GPIO lines</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpio_v2_line_config {
    __aligned_u64 flags;
    __u32 num_attrs;
    __u32 padding[5];
    struct gpio_v2_line_config_attribute attrs[GPIO_V2_LINE_NUM_ATTRS_MAX];
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">flags</span></code></dt><dd><p>flags for the GPIO lines, with values from <a class="reference internal" href="#c.gpio_v2_line_flag" title="gpio_v2_line_flag"><code class="xref c c-type docutils literal notranslate"><span class="pre">enum</span>
<span class="pre">gpio_v2_line_flag</span></code></a>, such as <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_ACTIVE_LOW</span></code>,
<code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_OUTPUT</span></code> etc, added together.  This is the default for
all requested lines but may be overridden for particular lines using
<strong>attrs</strong>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">num_attrs</span></code></dt><dd><p>the number of attributes in <strong>attrs</strong></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">padding</span></code></dt><dd><p>reserved for future use and must be zero filled</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">attrs</span></code></dt><dd><p>the configuration attributes associated with the requested
lines.  Any attribute should only be associated with a particular line
once.  If an attribute is associated with a line multiple times then the
first occurrence (i.e. lowest index) has precedence.</p>
</dd>
</dl>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpio_v2_line_request">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_request</span></span></span><a class="headerlink" href="#c.gpio_v2_line_request" title="Link to this definition">¶</a><br /></dt>
<dd><p>Information about a request for GPIO lines</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpio_v2_line_request {
    __u32 offsets[GPIO_V2_LINES_MAX];
    char consumer[GPIO_MAX_NAME_SIZE];
    struct gpio_v2_line_config config;
    __u32 num_lines;
    __u32 event_buffer_size;
    __u32 padding[5];
    __s32 fd;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">offsets</span></code></dt><dd><p>an array of desired lines, specified by offset index for the
associated GPIO chip</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">consumer</span></code></dt><dd><p>a desired consumer label for the selected GPIO lines such as
“my-bitbanged-relay”</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">config</span></code></dt><dd><p>requested configuration for the lines</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">num_lines</span></code></dt><dd><p>number of lines requested in this request, i.e. the number
of valid fields in the <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINES_MAX</span></code> sized arrays, set to 1 to
request a single line</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">event_buffer_size</span></code></dt><dd><p>a suggested minimum number of line events that the
kernel should buffer.  This is only relevant if edge detection is
enabled in the configuration. Note that this is only a suggested value
and the kernel may allocate a larger buffer or cap the size of the
buffer. If this field is zero then the buffer size defaults to a minimum
of <strong>num_lines</strong> * 16.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">padding</span></code></dt><dd><p>reserved for future use and must be zero filled</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fd</span></code></dt><dd><p>after a successful <code class="docutils literal notranslate"><span class="pre">GPIO_V2_GET_LINE_IOCTL</span></code> operation, contains
a valid anonymous file descriptor representing the request</p>
</dd>
</dl>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpio_v2_line_info">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_info</span></span></span><a class="headerlink" href="#c.gpio_v2_line_info" title="Link to this definition">¶</a><br /></dt>
<dd><p>Information about a certain GPIO line</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpio_v2_line_info {
    char name[GPIO_MAX_NAME_SIZE];
    char consumer[GPIO_MAX_NAME_SIZE];
    __u32 offset;
    __u32 num_attrs;
    __aligned_u64 flags;
    struct gpio_v2_line_attribute attrs[GPIO_V2_LINE_NUM_ATTRS_MAX];
    __u32 padding[4];
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">name</span></code></dt><dd><p>the name of this GPIO line, such as the output pin of the line on
the chip, a rail or a pin header name on a board, as specified by the
GPIO chip, may be empty (i.e. name[0] == ‘0’)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">consumer</span></code></dt><dd><p>a functional name for the consumer of this GPIO line as set
by whatever is using it, will be empty if there is no current user but
may also be empty if the consumer doesn’t set this up</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">offset</span></code></dt><dd><p>the local offset on this GPIO chip, fill this in when
requesting the line information from the kernel</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">num_attrs</span></code></dt><dd><p>the number of attributes in <strong>attrs</strong></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">flags</span></code></dt><dd><p>flags for this GPIO line, with values from <a class="reference internal" href="#c.gpio_v2_line_flag" title="gpio_v2_line_flag"><code class="xref c c-type docutils literal notranslate"><span class="pre">enum</span>
<span class="pre">gpio_v2_line_flag</span></code></a>, such as <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_ACTIVE_LOW</span></code>,
<code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_OUTPUT</span></code> etc, added together</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">attrs</span></code></dt><dd><p>the configuration attributes associated with the line</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">padding</span></code></dt><dd><p>reserved for future use</p>
</dd>
</dl>
</div>
<dl class="c enum">
<dt class="sig sig-object c" id="c.gpio_v2_line_changed_type">
<span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_changed_type</span></span></span><a class="headerlink" href="#c.gpio_v2_line_changed_type" title="Link to this definition">¶</a><br /></dt>
<dd><p><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">gpio_v2_line_changed</span></code>.event_type values</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_CHANGED_REQUESTED</span></code></dt><dd><p>line has been requested</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_CHANGED_RELEASED</span></code></dt><dd><p>line has been released</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_CHANGED_CONFIG</span></code></dt><dd><p>line has been reconfigured</p>
</dd>
</dl>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpio_v2_line_info_changed">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_info_changed</span></span></span><a class="headerlink" href="#c.gpio_v2_line_info_changed" title="Link to this definition">¶</a><br /></dt>
<dd><p>Information about a change in status of a GPIO line</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpio_v2_line_info_changed {
    struct gpio_v2_line_info info;
    __aligned_u64 timestamp_ns;
    __u32 event_type;
    __u32 padding[5];
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">info</span></code></dt><dd><p>updated line information</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">timestamp_ns</span></code></dt><dd><p>estimate of time of status change occurrence, in nanoseconds</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">event_type</span></code></dt><dd><p>the type of change with a value from <a class="reference internal" href="#c.gpio_v2_line_changed_type" title="gpio_v2_line_changed_type"><code class="xref c c-type docutils literal notranslate"><span class="pre">enum</span>
<span class="pre">gpio_v2_line_changed_type</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">padding</span></code></dt><dd><p>reserved for future use</p>
</dd>
</dl>
</div>
<dl class="c enum">
<dt class="sig sig-object c" id="c.gpio_v2_line_event_id">
<span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_event_id</span></span></span><a class="headerlink" href="#c.gpio_v2_line_event_id" title="Link to this definition">¶</a><br /></dt>
<dd><p><a class="reference internal" href="#c.gpio_v2_line_event" title="gpio_v2_line_event"><code class="xref c c-type docutils literal notranslate"><span class="pre">struct</span> <span class="pre">gpio_v2_line_event</span></code></a>.id values</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_EVENT_RISING_EDGE</span></code></dt><dd><p>event triggered by a rising edge</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_EVENT_FALLING_EDGE</span></code></dt><dd><p>event triggered by a falling edge</p>
</dd>
</dl>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.gpio_v2_line_event">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gpio_v2_line_event</span></span></span><a class="headerlink" href="#c.gpio_v2_line_event" title="Link to this definition">¶</a><br /></dt>
<dd><p>The actual event being pushed to userspace</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct gpio_v2_line_event {
    __aligned_u64 timestamp_ns;
    __u32 id;
    __u32 offset;
    __u32 seqno;
    __u32 line_seqno;
    __u32 padding[6];
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">timestamp_ns</span></code></dt><dd><p>best estimate of time of event occurrence, in nanoseconds</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">id</span></code></dt><dd><p>event identifier with value from <a class="reference internal" href="#c.gpio_v2_line_event_id" title="gpio_v2_line_event_id"><code class="xref c c-type docutils literal notranslate"><span class="pre">enum</span> <span class="pre">gpio_v2_line_event_id</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">offset</span></code></dt><dd><p>the offset of the line that triggered the event</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">seqno</span></code></dt><dd><p>the sequence number for this event in the sequence of events for
all the lines in this line request</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">line_seqno</span></code></dt><dd><p>the sequence number for this event in the sequence of
events on this particular line</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">padding</span></code></dt><dd><p>reserved for future use</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>By default the <strong>timestamp_ns</strong> is read from <code class="docutils literal notranslate"><span class="pre">CLOCK_MONOTONIC</span></code> and is
intended to allow the accurate measurement of the time between events.
It does not provide the wall-clock time.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_EVENT_CLOCK_REALTIME</span></code> flag is set then the
<strong>timestamp_ns</strong> is read from <code class="docutils literal notranslate"><span class="pre">CLOCK_REALTIME</span></code>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">GPIO_V2_LINE_FLAG_EVENT_CLOCK_HTE</span></code> flag is set then the
<strong>timestamp_ns</strong> is provided by the hardware timestamping engine (HTE)
subsystem.</p>
<div class="toctree-wrapper compound">
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/userspace-api/gpio/chardev.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>