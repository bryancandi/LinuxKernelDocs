<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Message-based devices &#8212; The Linux Kernel  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=a152c8ac" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Miscellaneous Devices" href="misc_devices.html" />
    <link rel="prev" title="GPMC (General Purpose Memory Controller)" href="memory-devices/ti-gpmc.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.9.0</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><!-- SPDX-License-Identifier: GPL-2.0 -->

<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Driver APIs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#general-information-for-driver-authors">General information for driver authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#useful-support-libraries">Useful support libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#bus-level-documentation">Bus-level documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#subsystem-specific-apis">Subsystem-specific APIs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="80211/index.html">Linux 802.11 Driver Developer’s Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="acpi/index.html">ACPI Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="backlight/lp855x-driver.html">Kernel driver lp855x</a></li>
<li class="toctree-l3"><a class="reference internal" href="clk.html">The Common Clk Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="console.html">Console Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="crypto/index.html">Crypto Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="dmaengine/index.html">DMAEngine documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="dpll.html">The Linux kernel dpll subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="edac.html">Error Detection And Correction (EDAC) Devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="firmware/index.html">Linux Firmware API</a></li>
<li class="toctree-l3"><a class="reference internal" href="fpga/index.html">FPGA Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="frame-buffer.html">Frame Buffer Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="aperture.html">Managing Ownership of the Framebuffer Aperture</a></li>
<li class="toctree-l3"><a class="reference internal" href="generic-counter.html">Generic Counter Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="gpio/index.html">General Purpose Input/Output (GPIO)</a></li>
<li class="toctree-l3"><a class="reference internal" href="hsi.html">High Speed Synchronous Serial Interface (HSI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="hte/index.html">The Linux Hardware Timestamping Engine (HTE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="i2c.html">I<sup>2</sup>C and SMBus Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="iio/index.html">Industrial I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="infiniband.html">InfiniBand and Remote DMA (RDMA) Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="input.html">Input Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="interconnect.html">Generic System Interconnect Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="ipmb.html">IPMB Driver for a Satellite MC</a></li>
<li class="toctree-l3"><a class="reference internal" href="ipmi.html">The Linux IPMI Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="libata.html">libATA Developer’s Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="mailbox.html">The Common Mailbox Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="md/index.html">RAID</a></li>
<li class="toctree-l3"><a class="reference internal" href="media/index.html">Media subsystem kernel internal API</a></li>
<li class="toctree-l3"><a class="reference internal" href="mei/index.html">Intel(R) Management Engine Interface (Intel(R) MEI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory-devices/index.html">Memory Controller drivers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Message-based devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="misc_devices.html">Miscellaneous Devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="miscellaneous.html">Parallel Port Devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="miscellaneous.html#x50-uart-driver">16x50 UART Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="miscellaneous.html#pulse-width-modulation-pwm">Pulse-Width Modulation (PWM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmc/index.html">MMC/SD/SDIO card support</a></li>
<li class="toctree-l3"><a class="reference internal" href="mtd/index.html">Memory Technology Device (MTD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mtdnand.html">MTD NAND Driver Programming Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="nfc/index.html">Near Field Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="ntb.html">NTB Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="nvdimm/index.html">Non-Volatile Memory Device (NVDIMM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="nvmem.html">NVMEM Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="parport-lowlevel.html">PARPORT interface documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="phy/index.html">Generic PHY Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="pin-control.html">PINCTRL (PIN CONTROL) subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="pldmfw/index.html">PLDM Firmware Flash Update Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="pldmfw/index.html#overview-of-the-pldmfw-library">Overview of the <code class="docutils literal notranslate"><span class="pre">pldmfw</span></code> library</a></li>
<li class="toctree-l3"><a class="reference internal" href="pps.html">PPS - Pulse Per Second</a></li>
<li class="toctree-l3"><a class="reference internal" href="ptp.html">PTP hardware clock infrastructure for Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="pwm.html">Pulse Width Modulation (PWM) interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="regulator.html">Voltage and current regulator API</a></li>
<li class="toctree-l3"><a class="reference internal" href="reset.html">Reset controller API</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfkill.html">rfkill - RF kill switch support</a></li>
<li class="toctree-l3"><a class="reference internal" href="s390-drivers.html">Writing s390 channel device drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="scsi.html">SCSI Interfaces Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="serial/index.html">Support for Serial devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="sm501.html">SM501 Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="soundwire/index.html">SoundWire Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="spi.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="surface_aggregator/index.html">Surface System Aggregator Module (SSAM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="switchtec.html">Linux Switchtec Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="sync_file.html">Sync File API Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="target.html">target and iSCSI Interfaces Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="tee.html">TEE (Trusted Execution Environment) driver API</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal/index.html">Thermal</a></li>
<li class="toctree-l3"><a class="reference internal" href="tty/index.html">TTY</a></li>
<li class="toctree-l3"><a class="reference internal" href="wbrf.html">WBRF - Wifi Band RFI Mitigations</a></li>
<li class="toctree-l3"><a class="reference internal" href="wmi.html">WMI Driver API</a></li>
<li class="toctree-l3"><a class="reference internal" href="xilinx/index.html">Xilinx FPGA</a></li>
<li class="toctree-l3"><a class="reference internal" href="zorro.html">Writing Device Drivers for Zorro Devices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../subsystem-apis.html">Subsystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">Userspace API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/driver-api/message-based.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <!-- SPDX-License-Identifier: GPL-2.0 -->
<!-- Copyright © 2023, Oracle and/or its affiliates. -->


<section id="message-based-devices">
<h1>Message-based devices<a class="headerlink" href="#message-based-devices" title="Link to this heading">¶</a></h1>
<section id="fusion-message-devices">
<h2>Fusion message devices<a class="headerlink" href="#fusion-message-devices" title="Link to this heading">¶</a></h2>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_register">
<span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_register</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_CALLBACK</span></span><span class="w"> </span><span class="n"><span class="pre">cbfunc</span></span>, <span class="n"><span class="pre">MPT_DRIVER_CLASS</span></span><span class="w"> </span><span class="n"><span class="pre">dclass</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">func_name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_register" title="Link to this definition">¶</a><br /></dt>
<dd><p>Register protocol-specific main callback handler.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_CALLBACK</span> <span class="pre">cbfunc</span></code></dt><dd><p>callback function pointer</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_DRIVER_CLASS</span> <span class="pre">dclass</span></code></dt><dd><p>Protocol driver’s class (<code class="docutils literal notranslate"><span class="pre">MPT_DRIVER_CLASS</span></code> enum value)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*func_name</span></code></dt><dd><p>call function’s name</p>
<p>This routine is called by a protocol-specific driver (SCSI host,
LAN, SCSI target) to register its reply callback routine.  Each
protocol-specific driver must do this before it will be able to
use any IOC resources, such as obtaining request frames.</p>
</dd>
</dl>
<p><strong>NOTES</strong></p>
<dl>
<dt>The SCSI protocol driver currently calls this routine thrice</dt><dd><p>in order to register separate callbacks; one for “normal” SCSI IO;
one for MptScsiTaskMgmt requests; one for Scan/DV requests.</p>
<p>Returns u8 valued “handle” in the range (and S.O.D. order)
{N,...,7,6,5,...,1} if successful.
A return value of MPT_MAX_PROTOCOL_DRIVERS (including zero!) should be
considered an error by the caller.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_deregister">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_deregister</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_deregister" title="Link to this definition">¶</a><br /></dt>
<dd><p>Deregister a protocol drivers resources.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered callback handle</p>
<p>Each protocol-specific driver should call this routine when its
module is unloaded.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_event_register">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_event_register</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span>, <span class="n"><span class="pre">MPT_EVHANDLER</span></span><span class="w"> </span><span class="n"><span class="pre">ev_cbfunc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_event_register" title="Link to this definition">¶</a><br /></dt>
<dd><p>Register protocol-specific event callback handler.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered (via mpt_register) callback handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_EVHANDLER</span> <span class="pre">ev_cbfunc</span></code></dt><dd><p>callback function</p>
<p>This routine can be called by one or more protocol-specific drivers
if/when they choose to be notified of MPT events.</p>
<p>Returns 0 for success.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_event_deregister">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_event_deregister</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_event_deregister" title="Link to this definition">¶</a><br /></dt>
<dd><p>Deregister protocol-specific event callback handler</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered callback handle</p>
<p>Each protocol-specific driver should call this routine
when it does not (or can no longer) handle events,
or when its module is unloaded.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_reset_register">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_reset_register</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span>, <span class="n"><span class="pre">MPT_RESETHANDLER</span></span><span class="w"> </span><span class="n"><span class="pre">reset_func</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_reset_register" title="Link to this definition">¶</a><br /></dt>
<dd><p>Register protocol-specific IOC reset handler.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered (via mpt_register) callback handle</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_RESETHANDLER</span> <span class="pre">reset_func</span></code></dt><dd><p>reset function</p>
<p>This routine can be called by one or more protocol-specific drivers
if/when they choose to be notified of IOC resets.</p>
<p>Returns 0 for success.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_reset_deregister">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_reset_deregister</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_reset_deregister" title="Link to this definition">¶</a><br /></dt>
<dd><p>Deregister protocol-specific IOC reset handler.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>previously registered callback handle</p>
<p>Each protocol-specific driver should call this routine
when it does not (or can no longer) handle IOC reset handling,
or when its module is unloaded.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_device_driver_register">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_device_driver_register</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">mpt_pci_driver</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dd_cbfunc</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_device_driver_register" title="Link to this definition">¶</a><br /></dt>
<dd><p>Register device driver hooks</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">mpt_pci_driver</span> <span class="pre">*</span> <span class="pre">dd_cbfunc</span></code></dt><dd><p>driver callbacks struct</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>MPT protocol driver index</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_device_driver_deregister">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_device_driver_deregister</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_device_driver_deregister" title="Link to this definition">¶</a><br /></dt>
<dd><p>DeRegister device driver hooks</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>MPT protocol driver index</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_get_msg_frame">
<span class="n"><span class="pre">MPT_FRAME_HDR</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">mpt_get_msg_frame</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span>, <span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_get_msg_frame" title="Link to this definition">¶</a><br /></dt>
<dd><p>Obtain an MPT request frame from the pool</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>Handle of registered MPT protocol driver</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
<p>Obtain an MPT request frame from the pool (of 1024) that are
allocated per MPT adapter.</p>
<p>Returns pointer to a MPT request frame or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if none are available
or IOC is not active.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_put_msg_frame">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_put_msg_frame</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span>, <span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">MPT_FRAME_HDR</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_put_msg_frame" title="Link to this definition">¶</a><br /></dt>
<dd><p>Send a protocol-specific MPT request frame to an IOC</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>Handle of registered MPT protocol driver</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mf</span></code></dt><dd><p>Pointer to MPT request frame</p>
<p>This routine posts an MPT request frame to the request post FIFO of a
specific MPT adapter.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_put_msg_frame_hi_pri">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_put_msg_frame_hi_pri</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span>, <span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">MPT_FRAME_HDR</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_put_msg_frame_hi_pri" title="Link to this definition">¶</a><br /></dt>
<dd><p>Send a hi-pri protocol-specific MPT request frame</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>Handle of registered MPT protocol driver</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mf</span></code></dt><dd><p>Pointer to MPT request frame</p>
<p>Send a protocol-specific MPT request frame to an IOC using
hi-priority request queue.</p>
<p>This routine posts an MPT request frame to the request post FIFO of a
specific MPT adapter.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_free_msg_frame">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_free_msg_frame</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">MPT_FRAME_HDR</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_free_msg_frame" title="Link to this definition">¶</a><br /></dt>
<dd><p>Place MPT request frame back on FreeQ.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mf</span></code></dt><dd><p>Pointer to MPT request frame</p>
<p>This routine places a MPT request frame back on the MPT adapter’s
FreeQ.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_send_handshake_request">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_send_handshake_request</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">cb_idx</span></span>, <span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">reqBytes</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">req</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">sleepFlag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_send_handshake_request" title="Link to this definition">¶</a><br /></dt>
<dd><p>Send MPT request via doorbell handshake method.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt><dd><p>Handle of registered MPT protocol driver</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">reqBytes</span></code></dt><dd><p>Size of the request in bytes</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*req</span></code></dt><dd><p>Pointer to MPT request frame</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt><dd><p>Use schedule if CAN_SLEEP else use udelay.</p>
<p>This routine is used exclusively to send MptScsiTaskMgmt
requests since they are required to be sent via doorbell handshake.</p>
</dd>
</dl>
<p><strong>NOTE</strong></p>
<dl>
<dt>It is the callers responsibility to byte-swap fields in the</dt><dd><p>request which are greater than 1 byte in size.</p>
<p>Returns 0 for success, non-zero for failure.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_verify_adapter">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_verify_adapter</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">iocid</span></span>, <span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">iocpp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_verify_adapter" title="Link to this definition">¶</a><br /></dt>
<dd><p>Given IOC identifier, set pointer to its adapter structure.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">iocid</span></code></dt><dd><p>IOC unique identifier (integer)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">**iocpp</span></code></dt><dd><p>Pointer to pointer to IOC adapter</p>
<p>Given a unique IOC identifier, set pointer to the associated MPT
adapter structure.</p>
<p>Returns iocid and sets iocpp if iocid is found.
Returns -1 if iocid is not found.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_attach">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_attach</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../PCI/pci.html#c.pci_device_id" title="pci_device_id"><span class="n"><span class="pre">pci_device_id</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_attach" title="Link to this definition">¶</a><br /></dt>
<dd><p>Install a PCI intelligent MPT adapter.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>Pointer to pci_dev structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">pci_device_id</span> <span class="pre">*id</span></code></dt><dd><p>PCI device ID information</p>
<p>This routine performs all the steps necessary to bring the IOC of
a MPT adapter to a OPERATIONAL state.  This includes registering
memory regions, registering the interrupt, and allocating request
and reply memory pools.</p>
<p>This routine also pre-fetches the LAN MAC address of a Fibre Channel
MPT adapter.</p>
<p>Returns 0 for success, non-zero for failure.</p>
<p>TODO: Add support for polled controllers</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_detach">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_detach</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_detach" title="Link to this definition">¶</a><br /></dt>
<dd><p>Remove a PCI intelligent MPT adapter.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>Pointer to pci_dev structure</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_suspend">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_suspend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span>, <span class="n"><span class="pre">pm_message_t</span></span><span class="w"> </span><span class="n"><span class="pre">state</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_suspend" title="Link to this definition">¶</a><br /></dt>
<dd><p>Fusion MPT base driver suspend routine.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>Pointer to pci_dev structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pm_message_t</span> <span class="pre">state</span></code></dt><dd><p>new state to enter</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_resume">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_resume</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_resume" title="Link to this definition">¶</a><br /></dt>
<dd><p>Fusion MPT base driver resume routine.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>Pointer to pci_dev structure</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_GetIocState">
<span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_GetIocState</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">cooked</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_GetIocState" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the current state of a MPT adapter.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">cooked</span></code></dt><dd><p>Request raw or cooked IOC state</p>
<p>Returns all IOC Doorbell register bits if cooked==0, else just the
Doorbell bits in MPI_IOC_STATE_MASK.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_alloc_fw_memory">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_alloc_fw_memory</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_alloc_fw_memory" title="Link to this definition">¶</a><br /></dt>
<dd><p>allocate firmware memory</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">size</span></code></dt><dd><p>total FW bytes</p>
<p>If memory has already been allocated, the same (cached) value
is returned.</p>
<p>Return 0 if successful, or non-zero for failure</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_free_fw_memory">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_free_fw_memory</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_free_fw_memory" title="Link to this definition">¶</a><br /></dt>
<dd><p>free firmware memory</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
<p>If alt_img is NULL, delete from ioc structure.
Else, delete a secondary image in same format.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptbase_sas_persist_operation">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptbase_sas_persist_operation</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">persist_opcode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptbase_sas_persist_operation" title="Link to this definition">¶</a><br /></dt>
<dd><p>Perform operation on SAS Persistent Table</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">persist_opcode</span></code></dt><dd><p>see below</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>MPI_SAS_OP_CLEAR_NOT_PRESENT</p></td>
<td><p>Free all persist TargetID mappings for
devices not currently present.</p></td>
</tr>
<tr class="row-even"><td><p>MPI_SAS_OP_CLEAR_ALL_PERSISTENT</p></td>
<td><p>Clear al persist TargetID mappings</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p><strong>NOTE</strong></p>
<p>Don’t use not this function during interrupt time.</p>
<blockquote>
<div><p>Returns 0 for success, non-zero error</p>
</div></blockquote>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_raid_phys_disk_pg0">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_raid_phys_disk_pg0</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">phys_disk_num</span></span>, <span class="n"><span class="pre">RaidPhysDiskPage0_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">phys_disk</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_pg0" title="Link to this definition">¶</a><br /></dt>
<dd><p>returns phys disk page zero</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to a Adapter Structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt><dd><p>io unit unique phys disk num generated by the ioc</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RaidPhysDiskPage0_t</span> <span class="pre">*phys_disk</span></code></dt><dd><p>requested payload data returned</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div><p>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</p>
</div></blockquote>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_raid_phys_disk_get_num_paths">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_raid_phys_disk_get_num_paths</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">phys_disk_num</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_get_num_paths" title="Link to this definition">¶</a><br /></dt>
<dd><p>returns number paths associated to this phys_num</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to a Adapter Structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt><dd><p>io unit unique phys disk num generated by the ioc</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div><p>returns number paths</p>
</div></blockquote>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_raid_phys_disk_pg1">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_raid_phys_disk_pg1</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">phys_disk_num</span></span>, <span class="n"><span class="pre">RaidPhysDiskPage1_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">phys_disk</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_pg1" title="Link to this definition">¶</a><br /></dt>
<dd><p>returns phys disk page 1</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to a Adapter Structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt><dd><p>io unit unique phys disk num generated by the ioc</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RaidPhysDiskPage1_t</span> <span class="pre">*phys_disk</span></code></dt><dd><p>requested payload data returned</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div><p>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</p>
</div></blockquote>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_findImVolumes">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_findImVolumes</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_findImVolumes" title="Link to this definition">¶</a><br /></dt>
<dd><p>Identify IDs of hidden disks and RAID Volumes</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to a Adapter Strucutre</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div><p>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</p>
</div></blockquote>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_config">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_config</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">CONFIGPARMS</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pCfg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_config" title="Link to this definition">¶</a><br /></dt>
<dd><p>Generic function to issue config message</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to an adapter structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CONFIGPARMS</span> <span class="pre">*pCfg</span></code></dt><dd><p>Pointer to a configuration structure. Struct contains
action, page address, direction, physical address
and pointer to a configuration page header
Page header is updated.</p>
<blockquote>
<div><p>Returns 0 for success
-EAGAIN if no msg frames currently available
-EFAULT for non-successful reply or no reply (timeout)</p>
</div></blockquote>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_print_ioc_summary">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_print_ioc_summary</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buffer</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">showlan</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_print_ioc_summary" title="Link to this definition">¶</a><br /></dt>
<dd><p>Write ASCII summary of IOC to a buffer.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*buffer</span></code></dt><dd><p>Pointer to buffer where IOC summary info should be written</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">*size</span></code></dt><dd><p>Pointer to number of bytes we wrote (set by this routine)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">len</span></code></dt><dd><p>Offset at which to start writing in buffer</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">showlan</span></code></dt><dd><p>Display LAN stuff?</p>
<p>This routine writes (english readable) ASCII text, which represents
a summary of IOC information, to a buffer.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_set_taskmgmt_in_progress_flag">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_set_taskmgmt_in_progress_flag</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_set_taskmgmt_in_progress_flag" title="Link to this definition">¶</a><br /></dt>
<dd><p>set flags associated with task management</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
<p>Returns 0 for SUCCESS or -1 if FAILED.</p>
<p>If -1 is return, then it was not possible to set the flags</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_clear_taskmgmt_in_progress_flag">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_clear_taskmgmt_in_progress_flag</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_clear_taskmgmt_in_progress_flag" title="Link to this definition">¶</a><br /></dt>
<dd><p>clear flags associated with task management</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_halt_firmware">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="pre">__noreturn</span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_halt_firmware</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_halt_firmware" title="Link to this definition">¶</a><br /></dt>
<dd><p>Halts the firmware if it is operational and panic the kernel</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_Soft_Hard_ResetHandler">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_Soft_Hard_ResetHandler</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">sleepFlag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_Soft_Hard_ResetHandler" title="Link to this definition">¶</a><br /></dt>
<dd><p>Try less expensive reset</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt><dd><p>Indicates if sleep or schedule must be called.</p>
<p>Returns 0 for SUCCESS or -1 if FAILED.
Try for softreset first, only if it fails go for expensive
HardReset.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mpt_HardResetHandler">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mpt_HardResetHandler</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">sleepFlag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_HardResetHandler" title="Link to this definition">¶</a><br /></dt>
<dd><p>Generic reset handler</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt><dd><p>Indicates if sleep or schedule must be called.</p>
<p>Issues SCSI Task Management call based on input arg values.
If TaskMgmt fails, returns associated SCSI request.</p>
<p>Remark: _HardResetHandler can be invoked from an interrupt thread (timer)
or a non-interrupt thread.  In the former, must not call schedule().</p>
</dd>
</dl>
<p><strong>Note</strong></p>
<dl>
<dt>A return of -1 is a FATAL error case, as it means a</dt><dd><p>FW reload/initialization failed.</p>
<p>Returns 0 for SUCCESS or -1 if FAILED.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_info">
<span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_info</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">Scsi_Host</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">SChost</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_info" title="Link to this definition">¶</a><br /></dt>
<dd><p>Return information about MPT adapter</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">Scsi_Host</span> <span class="pre">*SChost</span></code></dt><dd><p>Pointer to Scsi_Host structure</p>
<p>(linux scsi_host_template.info routine)</p>
<p>Returns pointer to buffer where information was written.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_qcmd">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_qcmd</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">scsi_cmnd</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">SCpnt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_qcmd" title="Link to this definition">¶</a><br /></dt>
<dd><p>Primary Fusion MPT SCSI initiator IO start routine.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure</p>
<p>(linux scsi_host_template.queuecommand routine)
This is the primary SCSI IO start routine.  Create a MPI SCSIIORequest
from a linux scsi_cmnd request and send it to the IOC.</p>
<p>Returns 0. (rtn value discarded by linux scsi mid-layer)</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_IssueTaskMgmt">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_IssueTaskMgmt</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_SCSI_HOST</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">hd</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">channel</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span>, <span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="n"><span class="pre">lun</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">ctx2abort</span></span>, <span class="n"><span class="pre">ulong</span></span><span class="w"> </span><span class="n"><span class="pre">timeout</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_IssueTaskMgmt" title="Link to this definition">¶</a><br /></dt>
<dd><p>Generic send Task Management function.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_SCSI_HOST</span> <span class="pre">*hd</span></code></dt><dd><p>Pointer to MPT_SCSI_HOST structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">type</span></code></dt><dd><p>Task Management type</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">channel</span></code></dt><dd><p>channel number for task management</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">id</span></code></dt><dd><p>Logical Target ID for reset (if appropriate)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u64</span> <span class="pre">lun</span></code></dt><dd><p>Logical Unit for reset (if appropriate)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">ctx2abort</span></code></dt><dd><p>Context for the task to be aborted (if appropriate)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ulong</span> <span class="pre">timeout</span></code></dt><dd><p>timeout for task management control</p>
<p>Remark: _HardResetHandler can be invoked from an interrupt thread (timer)
or a non-interrupt thread.  In the former, must not call schedule().</p>
<p>Not all fields are meaningfull for all task types.</p>
<p>Returns 0 for SUCCESS, or FAILED.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_abort">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_abort</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">scsi_cmnd</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">SCpnt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_abort" title="Link to this definition">¶</a><br /></dt>
<dd><p>Abort linux scsi_cmnd routine, new_eh variant</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO to be aborted</p>
<p>(linux scsi_host_template.eh_abort_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_dev_reset">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_dev_reset</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">scsi_cmnd</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">SCpnt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_dev_reset" title="Link to this definition">¶</a><br /></dt>
<dd><p>Perform a SCSI LOGICAL_UNIT_RESET!</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO which reset is due to</p>
<p>(linux scsi_host_template.eh_dev_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_target_reset">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_target_reset</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">scsi_cmnd</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">SCpnt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_target_reset" title="Link to this definition">¶</a><br /></dt>
<dd><p>Perform a SCSI TARGET_RESET!</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO which reset is due to</p>
<p>(linux scsi_host_template.eh_target_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_bus_reset">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_bus_reset</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">scsi_cmnd</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">SCpnt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_bus_reset" title="Link to this definition">¶</a><br /></dt>
<dd><p>Perform a SCSI BUS_RESET! new_eh variant</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO which reset is due to</p>
<p>(linux scsi_host_template.eh_bus_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_host_reset">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_host_reset</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">scsi_cmnd</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">SCpnt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_host_reset" title="Link to this definition">¶</a><br /></dt>
<dd><p>Perform a SCSI host adapter RESET (new_eh variant)</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*SCpnt</span></code></dt><dd><p>Pointer to scsi_cmnd structure, IO which reset is due to</p>
<p>(linux scsi_host_template.eh_host_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_taskmgmt_complete">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_taskmgmt_complete</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="n"><span class="pre">MPT_FRAME_HDR</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mf</span></span>, <span class="n"><span class="pre">MPT_FRAME_HDR</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_taskmgmt_complete" title="Link to this definition">¶</a><br /></dt>
<dd><p>Registered with Fusion MPT base driver</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mf</span></code></dt><dd><p>Pointer to SCSI task mgmt request frame</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*mr</span></code></dt><dd><p>Pointer to SCSI task mgmt reply frame</p>
<p>This routine is called from mptbase.c::mpt_interrupt() at the completion
of any SCSI task management request.
This routine is registered with the MPT (base) driver at driver
load/init time via the <a class="reference internal" href="#c.mpt_register" title="mpt_register"><code class="xref c c-func docutils literal notranslate"><span class="pre">mpt_register()</span></code></a> API call.</p>
<p>Returns 1 indicating alloc’d request frame ptr should be freed.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.mptscsih_get_scsi_lookup">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">scsi_cmnd</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">mptscsih_get_scsi_lookup</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPT_ADAPTER</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ioc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">i</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_get_scsi_lookup" title="Link to this definition">¶</a><br /></dt>
<dd><p>retrieves scmd entry</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">MPT_ADAPTER</span> <span class="pre">*ioc</span></code></dt><dd><p>Pointer to MPT_ADAPTER structure</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">i</span></code></dt><dd><p>index into the array</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Returns the scsi_cmd pointer</p>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/driver-api/message-based.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>