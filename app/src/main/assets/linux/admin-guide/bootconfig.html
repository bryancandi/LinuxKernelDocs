<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Boot Configuration &#8212; The Linux Kernel  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=a152c8ac" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linux Braille Console" href="braille-console.html" />
    <link rel="prev" title="Data flows that Relate some functions, and write packets" href="blockdev/drbd/figures.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.9.0</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><!-- SPDX-License-Identifier: GPL-2.0 -->

<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">All development-process docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../subsystem-apis.html">Subsystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Administration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="README.html">Linux kernel release 6.x &lt;http://kernel.org/&gt;</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel-parameters.html">The kernel’s command-line parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="devices.html">Linux allocated devices (4.x+ version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sysctl/index.html">Documentation for /proc/sys</a></li>
<li class="toctree-l2"><a class="reference internal" href="abi.html">Linux ABI description</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html">Feature status on all architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="hw-vuln/index.html">Hardware vulnerabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="reporting-regressions.html">Reporting regressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickly-build-trimmed-linux.html">How to quickly build a trimmed Linux kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="verify-bugs-and-bisect-regressions.html">How to verify bugs and bisect regressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="bug-hunting.html">Bug hunting</a></li>
<li class="toctree-l2"><a class="reference internal" href="bug-bisect.html">Bisecting a bug</a></li>
<li class="toctree-l2"><a class="reference internal" href="tainted-kernels.html">Tainted kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="ramoops.html">Ramoops oops/panic logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamic-debug-howto.html">Dynamic debug</a></li>
<li class="toctree-l2"><a class="reference internal" href="init.html">Explaining the “No working init found.” boot hang message</a></li>
<li class="toctree-l2"><a class="reference internal" href="kdump/index.html">Documentation for Kdump - The kexec-based Crash Dumping Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="perf/index.html">Performance monitor support</a></li>
<li class="toctree-l2"><a class="reference internal" href="pstore-blk.html">pstore block oops/panic logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="sysfs-rules.html">Rules on how to access information in sysfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="workload-tracing.html">Discovering Linux kernel subsystems used by a workload</a></li>
<li class="toctree-l2"><a class="reference internal" href="acpi/index.html">ACPI Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="aoe/index.html">ATA over Ethernet (AoE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="auxdisplay/index.html">Auxiliary Display Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="bcache.html">A block layer cache (bcache)</a></li>
<li class="toctree-l2"><a class="reference internal" href="binderfs.html">The Android binderfs Filesystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="binfmt-misc.html">Kernel Support for miscellaneous Binary Formats (binfmt_misc)</a></li>
<li class="toctree-l2"><a class="reference internal" href="blockdev/index.html">Block Devices</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Boot Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-file-syntax">Config File Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#proc-bootconfig">/proc/bootconfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-kernel-with-a-boot-config">Boot Kernel With a Boot Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kernel-parameters-via-boot-config">Kernel parameters via Boot Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-file-limitation">Config File Limitation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bootconfig-apis">Bootconfig APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions-and-structures">Functions and structures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="braille-console.html">Linux Braille Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="btmrvl.html">btmrvl driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="cgroup-v1/index.html">Control Groups version 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="cgroup-v2.html">Control Group v2</a></li>
<li class="toctree-l2"><a class="reference internal" href="cifs/index.html">CIFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="clearing-warn-once.html">Clearing WARN_ONCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpu-load.html">CPU load</a></li>
<li class="toctree-l2"><a class="reference internal" href="cputopology.html">How CPU topology info is exported via sysfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="dell_rbu.html">Dell Remote BIOS Update driver (dell_rbu)</a></li>
<li class="toctree-l2"><a class="reference internal" href="device-mapper/index.html">Device Mapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="edid.html">EDID</a></li>
<li class="toctree-l2"><a class="reference internal" href="efi-stub.html">The EFI Boot Stub</a></li>
<li class="toctree-l2"><a class="reference internal" href="ext4.html">ext4 General Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesystem-monitoring.html">File system Monitoring with fanotify</a></li>
<li class="toctree-l2"><a class="reference internal" href="nfs/index.html">NFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpio/index.html">GPIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="highuid.html">Notes on the change from 16-bit UIDs to 32-bit UIDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="hw_random.html">Hardware random number generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="initrd.html">Using the initial RAM disk (initrd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="iostats.html">I/O statistics fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="java.html">Java(tm) Binary Kernel Support for Linux v1.03</a></li>
<li class="toctree-l2"><a class="reference internal" href="jfs.html">IBM’s Journaled File System (JFS) for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel-per-CPU-kthreads.html">Reducing OS jitter due to per-cpu kthreads</a></li>
<li class="toctree-l2"><a class="reference internal" href="laptops/index.html">Laptop Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="lcd-panel-cgram.html">Parallel port LCD/Keypad Panel support</a></li>
<li class="toctree-l2"><a class="reference internal" href="ldm.html">LDM - Logical Disk Manager (Dynamic Disks)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lockup-watchdogs.html">Softlockup detector and hardlockup detector (aka nmi_watchdog)</a></li>
<li class="toctree-l2"><a class="reference internal" href="LSM/index.html">Linux Security Module Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="md.html">RAID arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="media/index.html">Media subsystem admin and user guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="mm/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-signing.html">Kernel module signing facility</a></li>
<li class="toctree-l2"><a class="reference internal" href="mono.html">Mono(tm) Binary Kernel Support for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespaces/index.html">Namespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="numastat.html">Numa policy hit/miss statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="parport.html">Parport</a></li>
<li class="toctree-l2"><a class="reference internal" href="perf-security.html">Perf events and tool security</a></li>
<li class="toctree-l2"><a class="reference internal" href="pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="pmf.html">Set udev rules for PMF Smart PC Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="pnp.html">Linux Plug and Play Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapidio.html">RapidIO Subsystem Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="RAS/main.html">Reliability, Availability and Serviceability (RAS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="RAS/error-decoding.html">Error decoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="RAS/address-translation.html">Address translation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtc.html">Real Time Clock (RTC) Drivers for Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="serial-console.html">Linux Serial Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="svga.html">Video Mode Selection Support 2.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="syscall-user-dispatch.html">Syscall User Dispatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="sysrq.html">Linux Magic System Request Key Hacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermal/index.html">Thermal Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="thunderbolt.html">USB4 and Thunderbolt</a></li>
<li class="toctree-l2"><a class="reference internal" href="ufs.html">Using UFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicode.html">Unicode support</a></li>
<li class="toctree-l2"><a class="reference internal" href="vga-softcursor.html">Software cursor for VGA</a></li>
<li class="toctree-l2"><a class="reference internal" href="video-output.html">Video Output Switcher Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="xfs.html">The SGI XFS Filesystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">Userspace API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/admin-guide/bootconfig.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <!-- SPDX-License-Identifier: GPL-2.0 -->
<!-- Copyright © 2023, Oracle and/or its affiliates. -->



<div class="language-selection">
English

<ul>

<li><a href="../translations/zh_CN/admin-guide/bootconfig.html">Chinese (Simplified)</a></li>

<li><a href="../translations/zh_TW/admin-guide/bootconfig.html">Chinese (Traditional)</a></li>

</ul>
</div>
<section id="boot-configuration">
<span id="bootconfig"></span><h1>Boot Configuration<a class="headerlink" href="#boot-configuration" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Masami Hiramatsu &lt;<a class="reference external" href="mailto:mhiramat&#37;&#52;&#48;kernel&#46;org">mhiramat<span>&#64;</span>kernel<span>&#46;</span>org</a>&gt;</p>
</dd>
</dl>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The boot configuration expands the current kernel command line to support
additional key-value data when booting the kernel in an efficient way.
This allows administrators to pass a structured-Key config file.</p>
</section>
<section id="config-file-syntax">
<h2>Config File Syntax<a class="headerlink" href="#config-file-syntax" title="Link to this heading">¶</a></h2>
<p>The boot config syntax is a simple structured key-value. Each key consists
of dot-connected-words, and key and value are connected by <code class="docutils literal notranslate"><span class="pre">=</span></code>. The value
has to be terminated by semi-colon (<code class="docutils literal notranslate"><span class="pre">;</span></code>) or newline (<code class="docutils literal notranslate"><span class="pre">\n</span></code>).
For array value, array entries are separated by comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>).</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>KEY[.WORD[...]] = VALUE[, VALUE2[...]][;]
</pre></div>
</div>
<p>Unlike the kernel command line syntax, spaces are OK around the comma and <code class="docutils literal notranslate"><span class="pre">=</span></code>.</p>
<p>Each key word must contain only alphabets, numbers, dash (<code class="docutils literal notranslate"><span class="pre">-</span></code>) or underscore
(<code class="docutils literal notranslate"><span class="pre">_</span></code>). And each value only contains printable characters or spaces except
for delimiters such as semi-colon (<code class="docutils literal notranslate"><span class="pre">;</span></code>), new-line (<code class="docutils literal notranslate"><span class="pre">\n</span></code>), comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>),
hash (<code class="docutils literal notranslate"><span class="pre">#</span></code>) and closing brace (<code class="docutils literal notranslate"><span class="pre">}</span></code>).</p>
<p>If you want to use those delimiters in a value, you can use either double-
quotes (<code class="docutils literal notranslate"><span class="pre">&quot;VALUE&quot;</span></code>) or single-quotes (<code class="docutils literal notranslate"><span class="pre">'VALUE'</span></code>) to quote it. Note that
you can not escape these quotes.</p>
<p>There can be a key which doesn’t have value or has an empty value. Those keys
are used for checking if the key exists or not (like a boolean).</p>
<section id="key-value-syntax">
<h3>Key-Value Syntax<a class="headerlink" href="#key-value-syntax" title="Link to this heading">¶</a></h3>
<p>The boot config file syntax allows user to merge partially same word keys
by brace. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo.bar.baz = value1
foo.bar.qux.quux = value2
</pre></div>
</div>
<p>These can be written also in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo.bar {
   baz = value1
   qux.quux = value2
}
</pre></div>
</div>
<p>Or more shorter, written as following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo.bar { baz = value1; qux.quux = value2 }
</pre></div>
</div>
<p>In both styles, same key words are automatically merged when parsing it
at boot time. So you can append similar trees or key-values.</p>
</section>
<section id="same-key-values">
<h3>Same-key Values<a class="headerlink" href="#same-key-values" title="Link to this heading">¶</a></h3>
<p>It is prohibited that two or more values or arrays share a same-key.
For example,:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo = bar, baz
foo = qux  # !ERROR! we can not re-define same key
</pre></div>
</div>
<p>If you want to update the value, you must use the override operator
<code class="docutils literal notranslate"><span class="pre">:=</span></code> explicitly. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo = bar, baz
foo := qux
</pre></div>
</div>
<p>then, the <code class="docutils literal notranslate"><span class="pre">qux</span></code> is assigned to <code class="docutils literal notranslate"><span class="pre">foo</span></code> key. This is useful for
overriding the default value by adding (partial) custom bootconfigs
without parsing the default bootconfig.</p>
<p>If you want to append the value to existing key as an array member,
you can use <code class="docutils literal notranslate"><span class="pre">+=</span></code> operator. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo = bar, baz
foo += qux
</pre></div>
</div>
<p>In this case, the key <code class="docutils literal notranslate"><span class="pre">foo</span></code> has <code class="docutils literal notranslate"><span class="pre">bar</span></code>, <code class="docutils literal notranslate"><span class="pre">baz</span></code> and <code class="docutils literal notranslate"><span class="pre">qux</span></code>.</p>
<p>Moreover, sub-keys and a value can coexist under a parent key.
For example, following config is allowed.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo = value1
foo.bar = value2
foo := value3 # This will update foo&#39;s value.
</pre></div>
</div>
<p>Note, since there is no syntax to put a raw value directly under a
structured key, you have to define it outside of the brace. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo {
    bar = value1
    bar {
        baz = value2
        qux = value3
    }
}
</pre></div>
</div>
<p>Also, the order of the value node under a key is fixed. If there
are a value and subkeys, the value is always the first child node
of the key. Thus if user specifies subkeys first, e.g.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo.bar = value1
foo = value2
</pre></div>
</div>
<p>In the program (and /proc/bootconfig), it will be shown as below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo = value2
foo.bar = value1
</pre></div>
</div>
</section>
<section id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Link to this heading">¶</a></h3>
<p>The config syntax accepts shell-script style comments. The comments starting
with hash (“#”) until newline (”n”) will be ignored.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># comment line
foo = value # value is set to foo.
bar = 1, # 1st element
      2, # 2nd element
      3  # 3rd element
</pre></div>
</div>
<p>This is parsed as below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foo = value
bar = 1, 2, 3
</pre></div>
</div>
<p>Note that you can not put a comment between value and delimiter(<code class="docutils literal notranslate"><span class="pre">,</span></code> or
<code class="docutils literal notranslate"><span class="pre">;</span></code>). This means following config has a syntax error</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>key = 1 # comment
      ,2
</pre></div>
</div>
</section>
</section>
<section id="proc-bootconfig">
<h2>/proc/bootconfig<a class="headerlink" href="#proc-bootconfig" title="Link to this heading">¶</a></h2>
<p>/proc/bootconfig is a user-space interface of the boot config.
Unlike /proc/cmdline, this file shows the key-value style list.
Each key-value pair is shown in each line with following style:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>KEY[.WORDS...] = &quot;[VALUE]&quot;[,&quot;VALUE2&quot;...]
</pre></div>
</div>
</section>
<section id="boot-kernel-with-a-boot-config">
<h2>Boot Kernel With a Boot Config<a class="headerlink" href="#boot-kernel-with-a-boot-config" title="Link to this heading">¶</a></h2>
<p>There are two options to boot the kernel with bootconfig: attaching the
bootconfig to the initrd image or embedding it in the kernel itself.</p>
<section id="attaching-a-boot-config-to-initrd">
<h3>Attaching a Boot Config to Initrd<a class="headerlink" href="#attaching-a-boot-config-to-initrd" title="Link to this heading">¶</a></h3>
<p>Since the boot configuration file is loaded with initrd by default,
it will be added to the end of the initrd (initramfs) image file with
padding, size, checksum and 12-byte magic word as below.</p>
<p>[initrd][bootconfig][padding][size(le32)][checksum(le32)][#BOOTCONFIGn]</p>
<p>The size and checksum fields are unsigned 32bit little endian value.</p>
<p>When the boot configuration is added to the initrd image, the total
file size is aligned to 4 bytes. To fill the gap, null characters
(<code class="docutils literal notranslate"><span class="pre">\0</span></code>) will be added. Thus the <code class="docutils literal notranslate"><span class="pre">size</span></code> is the length of the bootconfig
file + padding bytes.</p>
<p>The Linux kernel decodes the last part of the initrd image in memory to
get the boot configuration data.
Because of this “piggyback” method, there is no need to change or
update the boot loader and the kernel image itself as long as the boot
loader passes the correct initrd file size. If by any chance, the boot
loader passes a longer size, the kernel fails to find the bootconfig data.</p>
<p>To do this operation, Linux kernel provides <code class="docutils literal notranslate"><span class="pre">bootconfig</span></code> command under
tools/bootconfig, which allows admin to apply or delete the config file
to/from initrd image. You can build it by the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># make -C tools/bootconfig
</pre></div>
</div>
<p>To add your boot config file to initrd image, run bootconfig as below
(Old data is removed automatically if exists):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># tools/bootconfig/bootconfig -a your-config /boot/initrd.img-X.Y.Z
</pre></div>
</div>
<p>To remove the config from the image, you can use -d option as below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># tools/bootconfig/bootconfig -d /boot/initrd.img-X.Y.Z
</pre></div>
</div>
<p>Then add “bootconfig” on the normal kernel command line to tell the
kernel to look for the bootconfig at the end of the initrd file.
Alternatively, build your kernel with the <code class="docutils literal notranslate"><span class="pre">CONFIG_BOOT_CONFIG_FORCE</span></code>
Kconfig option selected.</p>
</section>
<section id="embedding-a-boot-config-into-kernel">
<h3>Embedding a Boot Config into Kernel<a class="headerlink" href="#embedding-a-boot-config-into-kernel" title="Link to this heading">¶</a></h3>
<p>If you can not use initrd, you can also embed the bootconfig file in the
kernel by Kconfig options. In this case, you need to recompile the kernel
with the following configs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_BOOT_CONFIG_EMBED=y
CONFIG_BOOT_CONFIG_EMBED_FILE=&quot;/PATH/TO/BOOTCONFIG/FILE&quot;
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CONFIG_BOOT_CONFIG_EMBED_FILE</span></code> requires an absolute path or a relative
path to the bootconfig file from source tree or object tree.
The kernel will embed it as the default bootconfig.</p>
<p>Just as when attaching the bootconfig to the initrd, you need <code class="docutils literal notranslate"><span class="pre">bootconfig</span></code>
option on the kernel command line to enable the embedded bootconfig, or,
alternatively, build your kernel with the <code class="docutils literal notranslate"><span class="pre">CONFIG_BOOT_CONFIG_FORCE</span></code>
Kconfig option selected.</p>
<p>Note that even if you set this option, you can override the embedded
bootconfig by another bootconfig which attached to the initrd.</p>
</section>
</section>
<section id="kernel-parameters-via-boot-config">
<h2>Kernel parameters via Boot Config<a class="headerlink" href="#kernel-parameters-via-boot-config" title="Link to this heading">¶</a></h2>
<p>In addition to the kernel command line, the boot config can be used for
passing the kernel parameters. All the key-value pairs under <code class="docutils literal notranslate"><span class="pre">kernel</span></code>
key will be passed to kernel cmdline directly. Moreover, the key-value
pairs under <code class="docutils literal notranslate"><span class="pre">init</span></code> will be passed to init process via the cmdline.
The parameters are concatenated with user-given kernel cmdline string
as the following order, so that the command line parameter can override
bootconfig parameters (this depends on how the subsystem handles parameters
but in general, earlier parameter will be overwritten by later one.):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[bootconfig params][cmdline params] -- [bootconfig init params][cmdline init params]
</pre></div>
</div>
<p>Here is an example of the bootconfig file for kernel/init parameters.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>kernel {
  root = 01234567-89ab-cdef-0123-456789abcd
}
init {
 splash
}
</pre></div>
</div>
<p>This will be copied into the kernel cmdline string as the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root=&quot;01234567-89ab-cdef-0123-456789abcd&quot; -- splash
</pre></div>
</div>
<p>If user gives some other command line like,:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ro bootconfig -- quiet
</pre></div>
</div>
<p>The final kernel cmdline will be the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root=&quot;01234567-89ab-cdef-0123-456789abcd&quot; ro bootconfig -- splash quiet
</pre></div>
</div>
</section>
<section id="config-file-limitation">
<h2>Config File Limitation<a class="headerlink" href="#config-file-limitation" title="Link to this heading">¶</a></h2>
<p>Currently the maximum config size size is 32KB and the total key-words (not
key-value entries) must be under 1024 nodes.
Note: this is not the number of entries but nodes, an entry must consume
more than 2 nodes (a key-word and a value). So theoretically, it will be
up to 512 key-value pairs. If keys contains 3 words in average, it can
contain 256 key-value pairs. In most cases, the number of config items
will be under 100 entries and smaller than 8KB, so it would be enough.
If the node number exceeds 1024, parser returns an error even if the file
size is smaller than 32KB. (Note that this maximum size is not including
the padding null characters.)
Anyway, since bootconfig command verifies it when appending a boot config
to initrd image, user can notice it before boot.</p>
</section>
<section id="bootconfig-apis">
<h2>Bootconfig APIs<a class="headerlink" href="#bootconfig-apis" title="Link to this heading">¶</a></h2>
<p>User can query or loop on key-value pairs, also it is possible to find
a root (prefix) key node and find key-values under that node.</p>
<p>If you have a key string, you can query the value directly with the key
using <a class="reference internal" href="#c.xbc_find_value" title="xbc_find_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_find_value()</span></code></a>. If you want to know what keys exist in the boot
config, you can use <a class="reference internal" href="#c.xbc_for_each_key_value" title="xbc_for_each_key_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_for_each_key_value()</span></code></a> to iterate key-value pairs.
Note that you need to use <a class="reference internal" href="#c.xbc_array_for_each_value" title="xbc_array_for_each_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_array_for_each_value()</span></code></a> for accessing
each array’s value, e.g.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vnode = NULL;
xbc_find_value(&quot;key.word&quot;, &amp;vnode);
if (vnode &amp;&amp; xbc_node_is_array(vnode))
   xbc_array_for_each_value(vnode, value) {
     printk(&quot;%s &quot;, value);
   }
</pre></div>
</div>
<p>If you want to focus on keys which have a prefix string, you can use
<a class="reference internal" href="#c.xbc_find_node" title="xbc_find_node"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_find_node()</span></code></a> to find a node by the prefix string, and iterate
keys under the prefix node with <a class="reference internal" href="#c.xbc_node_for_each_key_value" title="xbc_node_for_each_key_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_node_for_each_key_value()</span></code></a>.</p>
<p>But the most typical usage is to get the named value under prefix
or get the named array under prefix as below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>root = xbc_find_node(&quot;key.prefix&quot;);
value = xbc_node_find_value(root, &quot;option&quot;, &amp;vnode);
...
xbc_node_for_each_array_value(root, &quot;array-option&quot;, value, anode) {
   ...
}
</pre></div>
</div>
<p>This accesses a value of “key.prefix.option” and an array of
“key.prefix.array-option”.</p>
<p>Locking is not needed, since after initialization, the config becomes
read-only. All data and keys must be copied if you need to modify it.</p>
</section>
<section id="functions-and-structures">
<h2>Functions and structures<a class="headerlink" href="#functions-and-structures" title="Link to this heading">¶</a></h2>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_calc_checksum">
<span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_calc_checksum</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_calc_checksum" title="Link to this definition">¶</a><br /></dt>
<dd><p>Calculate checksum of bootconfig</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*data</span></code></dt><dd><p>Bootconfig data.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">uint32_t</span> <span class="pre">size</span></code></dt><dd><p>The size of the bootconfig data.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Calculate the checksum value of the bootconfig data.
The checksum will be used with the BOOTCONFIG_MAGIC and the size for
embedding the bootconfig in the initrd image.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_is_value">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_is_value</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_is_value" title="Link to this definition">¶</a><br /></dt>
<dd><p>Test the node is a value node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Test the <strong>node</strong> is a value node and return true if a value node, false if not.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_is_key">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_is_key</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_is_key" title="Link to this definition">¶</a><br /></dt>
<dd><p>Test the node is a key node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Test the <strong>node</strong> is a key node and return true if a key node, false if not.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_is_array">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_is_array</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_is_array" title="Link to this definition">¶</a><br /></dt>
<dd><p>Test the node is an arraied value node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Test the <strong>node</strong> is an arraied value node.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_is_leaf">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_is_leaf</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_is_leaf" title="Link to this definition">¶</a><br /></dt>
<dd><p>Test the node is a leaf key node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Test the <strong>node</strong> is a leaf key node which is a key node and has a value node
or no child. Returns true if it is a leaf node, or false if not.
Note that the leaf node can have subkey nodes in addition to the
value node.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_find_value">
<span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_find_value</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vnode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_find_value" title="Link to this definition">¶</a><br /></dt>
<dd><p>Find a value which matches the key</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*key</span></code></dt><dd><p>Search key</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">**vnode</span></code></dt><dd><p>A container pointer of XBC value node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Search a value whose key matches <strong>key</strong> from whole of XBC tree and return
the value if found. Found value node is stored in <strong>*vnode</strong>.
Note that this can return 0-length string and store NULL in <strong>*vnode</strong> for
key-only (non-value) entry.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_find_node">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_find_node</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_find_node" title="Link to this definition">¶</a><br /></dt>
<dd><p>Find a node which matches the key</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*key</span></code></dt><dd><p>Search key</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Search a (key) node whose key matches <strong>key</strong> from whole of XBC tree and
return the node if found. If not found, returns NULL.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_get_subkey">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_get_subkey</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_get_subkey" title="Link to this definition">¶</a><br /></dt>
<dd><p>Return the first subkey node if exists</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>Parent node</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Return the first subkey node of the <strong>node</strong>. If the <strong>node</strong> has no child
or only value node, this will return NULL.</p>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.xbc_array_for_each_value">
<span class="sig-name descname"><span class="n"><span class="pre">xbc_array_for_each_value</span></span></span><a class="headerlink" href="#c.xbc_array_for_each_value" title="Link to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">xbc_array_for_each_value</span> <span class="pre">(anode,</span> <span class="pre">value)</span></code></p>
<blockquote>
<div><p>Iterate value nodes on an array</p>
</div></blockquote>
<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">anode</span></code></dt><dd><p>An XBC arraied value node</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">value</span></code></dt><dd><p>A value</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Iterate array value nodes and values starts from <strong>anode</strong>. This is expected to
be used with <a class="reference internal" href="#c.xbc_find_value" title="xbc_find_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_find_value()</span></code></a> and <a class="reference internal" href="#c.xbc_node_find_value" title="xbc_node_find_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_node_find_value()</span></code></a>, so that user can
process each array entry node.</p>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.xbc_node_for_each_child">
<span class="sig-name descname"><span class="n"><span class="pre">xbc_node_for_each_child</span></span></span><a class="headerlink" href="#c.xbc_node_for_each_child" title="Link to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">xbc_node_for_each_child</span> <span class="pre">(parent,</span> <span class="pre">child)</span></code></p>
<blockquote>
<div><p>Iterate child nodes</p>
</div></blockquote>
<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">parent</span></code></dt><dd><p>An XBC node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">child</span></code></dt><dd><p>Iterated XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Iterate child nodes of <strong>parent</strong>. Each child nodes are stored to <strong>child</strong>.
The <strong>child</strong> can be mixture of a value node and subkey nodes.</p>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.xbc_node_for_each_subkey">
<span class="sig-name descname"><span class="n"><span class="pre">xbc_node_for_each_subkey</span></span></span><a class="headerlink" href="#c.xbc_node_for_each_subkey" title="Link to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">xbc_node_for_each_subkey</span> <span class="pre">(parent,</span> <span class="pre">child)</span></code></p>
<blockquote>
<div><p>Iterate child subkey nodes</p>
</div></blockquote>
<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">parent</span></code></dt><dd><p>An XBC node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">child</span></code></dt><dd><p>Iterated XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Iterate subkey nodes of <strong>parent</strong>. Each child nodes are stored to <strong>child</strong>.
The <strong>child</strong> is only the subkey node.</p>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.xbc_node_for_each_array_value">
<span class="sig-name descname"><span class="n"><span class="pre">xbc_node_for_each_array_value</span></span></span><a class="headerlink" href="#c.xbc_node_for_each_array_value" title="Link to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">xbc_node_for_each_array_value</span> <span class="pre">(node,</span> <span class="pre">key,</span> <span class="pre">anode,</span> <span class="pre">value)</span></code></p>
<blockquote>
<div><p>Iterate array entries of geven key</p>
</div></blockquote>
<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">node</span></code></dt><dd><p>An XBC node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">key</span></code></dt><dd><p>A key string searched under <strong>node</strong></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">anode</span></code></dt><dd><p>Iterated XBC node of array entry.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">value</span></code></dt><dd><p>Iterated value of array entry.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Iterate array entries of given <strong>key</strong> under <strong>node</strong>. Each array entry node
is stored to <strong>anode</strong> and <strong>value</strong>. If the <strong>node</strong> doesn’t have <strong>key</strong> node,
it does nothing.
Note that even if the found key node has only one value (not array)
this executes block once. However, if the found key node has no value
(key-only node), this does nothing. So don’t use this for testing the
key-value pair existence.</p>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.xbc_node_for_each_key_value">
<span class="sig-name descname"><span class="n"><span class="pre">xbc_node_for_each_key_value</span></span></span><a class="headerlink" href="#c.xbc_node_for_each_key_value" title="Link to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">xbc_node_for_each_key_value</span> <span class="pre">(node,</span> <span class="pre">knode,</span> <span class="pre">value)</span></code></p>
<blockquote>
<div><p>Iterate key-value pairs under a node</p>
</div></blockquote>
<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">node</span></code></dt><dd><p>An XBC node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">knode</span></code></dt><dd><p>Iterated key node</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">value</span></code></dt><dd><p>Iterated value string</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Iterate key-value pairs under <strong>node</strong>. Each key node and value string are
stored in <strong>knode</strong> and <strong>value</strong> respectively.</p>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.xbc_for_each_key_value">
<span class="sig-name descname"><span class="n"><span class="pre">xbc_for_each_key_value</span></span></span><a class="headerlink" href="#c.xbc_for_each_key_value" title="Link to this definition">¶</a><br /></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">xbc_for_each_key_value</span> <span class="pre">(knode,</span> <span class="pre">value)</span></code></p>
<blockquote>
<div><p>Iterate key-value pairs</p>
</div></blockquote>
<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">knode</span></code></dt><dd><p>Iterated key node</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">value</span></code></dt><dd><p>Iterated value string</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Iterate key-value pairs in whole XBC tree. Each key node and value string
are stored in <strong>knode</strong> and <strong>value</strong> respectively.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_compose_key">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_compose_key</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_compose_key" title="Link to this definition">¶</a><br /></dt>
<dd><p>Compose full key string of the XBC node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*buf</span></code></dt><dd><p>A buffer to store the key.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">size</span></code></dt><dd><p>The size of the <strong>buf</strong>.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Compose the full-length key of the <strong>node</strong> into <strong>buf</strong>. Returns the total
length of the key stored in <strong>buf</strong>. Or returns -EINVAL if <strong>node</strong> is NULL,
and -ERANGE if the key depth is deeper than max depth.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_get_info">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_get_info</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node_size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_get_info" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the information of loaded boot config</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">*node_size</span></code></dt><dd><p>A pointer to store the number of nodes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">*data_size</span></code></dt><dd><p>A pointer to store the size of bootconfig data.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Get the number of used nodes in <strong>node_size</strong> if it is not NULL,
and the size of bootconfig data in <strong>data_size</strong> if it is not NULL.
Return 0 if the boot config is initialized, or return -ENODEV.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_root_node">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_root_node</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_root_node" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the root node of extended boot config</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span></code></dt><dd><p>no arguments</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Return the address of root node of extended boot config. If the
extended boot config is not initiized, return NULL.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_index">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_index" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the index of XBC node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>A target node of getting index.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Return the index number of <strong>node</strong> in XBC node list.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_get_parent">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_get_parent</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_get_parent" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the parent XBC node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Return the parent node of <strong>node</strong>. If the node is top node of the tree,
return NULL.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_get_child">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_get_child</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_get_child" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the child XBC node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Return the first child node of <strong>node</strong>. If the node has no child, return
NULL.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_get_next">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_get_next</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_get_next" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the next sibling XBC node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Return the NEXT sibling node of <strong>node</strong>. If the node has no next sibling,
return NULL. Note that even if this returns NULL, it doesn’t mean <strong>node</strong>
has no siblings. (You also has to check whether the parent’s child node
is <strong>node</strong> or not.)</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_get_data">
<span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_get_data</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_get_data" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the data of XBC node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Return the data (which is always a null terminated string) of <strong>node</strong>.
If the node has invalid data, warn and return NULL.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_find_subkey">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_find_subkey</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parent</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_find_subkey" title="Link to this definition">¶</a><br /></dt>
<dd><p>Find a subkey node which matches given key</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*parent</span></code></dt><dd><p>An XBC node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*key</span></code></dt><dd><p>A key string.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Search a key node under <strong>parent</strong> which matches <strong>key</strong>. The <strong>key</strong> can contain
several words jointed with ‘.’. If <strong>parent</strong> is NULL, this searches the
node from whole tree. Return NULL if no node is matched.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_find_value">
<span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_find_value</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parent</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vnode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_find_value" title="Link to this definition">¶</a><br /></dt>
<dd><p>Find a value node which matches given key</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*parent</span></code></dt><dd><p>An XBC node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*key</span></code></dt><dd><p>A key string.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">**vnode</span></code></dt><dd><p>A container pointer of found XBC node.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Search a value node under <strong>parent</strong> whose (parent) key node matches <strong>key</strong>,
store it in <strong>*vnode</strong>, and returns the value string.
The <strong>key</strong> can contain several words jointed with ‘.’. If <strong>parent</strong> is NULL,
this searches the node from whole tree. Return the value string if a
matched key found, return NULL if no node is matched.
Note that this returns 0-length string and stores NULL in <strong>*vnode</strong> if the
key has no value. And also it will return the value of the first entry if
the value is an array.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_compose_key_after">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_compose_key_after</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">root</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buf</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_compose_key_after" title="Link to this definition">¶</a><br /></dt>
<dd><p>Compose partial key string of the XBC node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*root</span></code></dt><dd><p>Root XBC node</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>Target XBC node.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*buf</span></code></dt><dd><p>A buffer to store the key.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">size</span></code></dt><dd><p>The size of the <strong>buf</strong>.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Compose the partial key of the <strong>node</strong> into <strong>buf</strong>, which is starting right
after <strong>root</strong> (<strong>root</strong> is not included.) If <strong>root</strong> is NULL, this returns full
key words of <strong>node</strong>.
Returns the total length of the key stored in <strong>buf</strong>. Returns -EINVAL
if <strong>node</strong> is NULL or <strong>root</strong> is not the ancestor of <strong>node</strong> or <strong>root</strong> is <strong>node</strong>,
or returns -ERANGE if the key depth is deeper than max depth.
This is expected to be used with <a class="reference internal" href="#c.xbc_find_node" title="xbc_find_node"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_find_node()</span></code></a> to list up all (child)
keys under given key.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_find_next_leaf">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_find_next_leaf</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">root</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_find_next_leaf" title="Link to this definition">¶</a><br /></dt>
<dd><p>Find the next leaf node under given node</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*root</span></code></dt><dd><p>An XBC root node</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*node</span></code></dt><dd><p>An XBC node which starts from.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Search the next leaf node (which means the terminal key node) of <strong>node</strong>
under <strong>root</strong> node (including <strong>root</strong> node itself).
Return the next node or NULL if next leaf node is not found.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_node_find_next_key_value">
<span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xbc_node_find_next_key_value</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">root</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xbc_node</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">leaf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_node_find_next_key_value" title="Link to this definition">¶</a><br /></dt>
<dd><p>Find the next key-value pair nodes</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">*root</span></code></dt><dd><p>An XBC root node</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xbc_node</span> <span class="pre">**leaf</span></code></dt><dd><p>A container pointer of XBC node which starts from.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Search the next leaf node (which means the terminal key node) of <strong>*leaf</strong>
under <strong>root</strong> node. Returns the value and update <strong>*leaf</strong> if next leaf node
is found, or NULL if no next leaf node is found.
Note that this returns 0-length string if the key has no value, or
the value of the first entry if the value is an array.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c._xbc_exit">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_xbc_exit</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n"><span class="pre">early</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c._xbc_exit" title="Link to this definition">¶</a><br /></dt>
<dd><p>Clean up all parsed bootconfig</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">bool</span> <span class="pre">early</span></code></dt><dd><p>Set true if this is called before budy system is initialized.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This clears all data structures of parsed bootconfig on memory.
If you need to reuse <a class="reference internal" href="#c.xbc_init" title="xbc_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">xbc_init()</span></code></a> with new boot config, you can
use this.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xbc_init">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xbc_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">emsg</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">epos</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xbc_init" title="Link to this definition">¶</a><br /></dt>
<dd><p>Parse given XBC file and build XBC internal tree</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*data</span></code></dt><dd><p>The boot config text original data</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">size</span></code></dt><dd><p>The size of <strong>data</strong></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">**emsg</span></code></dt><dd><p>A pointer of const char * to store the error message</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">*epos</span></code></dt><dd><p>A pointer of int to store the error position</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This parses the boot config text in <strong>data</strong>. <strong>size</strong> must be smaller
than XBC_DATA_MAX.
Return the number of stored nodes (&gt;0) if succeeded, or -errno
if there is any error.
In error cases, <strong>emsg</strong> will be updated with an error message and
<strong>epos</strong> will be updated with the error position which is the byte offset
of <strong>buf</strong>. If the error is not a parser error, <strong>epos</strong> will be -1.</p>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/admin-guide/bootconfig.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>