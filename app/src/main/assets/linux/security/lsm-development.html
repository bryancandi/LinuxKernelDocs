
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Linux Security Module Development &#8212; The Linux Kernel  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linux Secure Attention Key (SAK) handling" href="sak.html" />
    <link rel="prev" title="Linux Security Modules: General Security Hooks for Linux" href="lsm.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.7.0</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><!-- SPDX-License-Identifier: GPL-2.0 -->

<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/development-process.html">A guide to the Kernel Development Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/submitting-patches.html">Submitting patches: the essential guide to getting your code into the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">Driver implementer's API guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../subsystem-apis.html">Kernel subsystem documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#core-subsystems">Core subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#human-interfaces">Human interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#networking-interfaces">Networking interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../subsystem-apis.html#storage-interfaces">Storage interfaces</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cdrom/index.html">CD-ROM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scsi/index.html">SCSI Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpu-freq/index.html">CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fpga/index.html">FPGA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pcmcia/index.html">PCMCIA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../watchdog/index.html">Watchdog Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../virt/index.html">Virtualization Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hwmon/index.html">Hardware Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accel/index.html">Compute Accelerators</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Security Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../crypto/index.html">Crypto API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PCI/index.html">PCI Bus Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peci/index.html">PECI Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wmi/index.html">WMI Subsystem</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">Locking in the kernel</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Linux kernel licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/testing-overview.html">Kernel Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user's and administrator's guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">The kernel build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">User-space tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arch/index.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  sbar.scrollTop = currents[currents.length - 1].offsetTop;
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/security/lsm-development.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="linux-security-module-development">
<h1>Linux Security Module Development<a class="headerlink" href="#linux-security-module-development" title="Permalink to this heading">¶</a></h1>
<p>Based on <a class="reference external" href="https://lore.kernel.org/r/20071026073721.618b4778&#64;laptopd505.fenrus.org">https://lore.kernel.org/r/20071026073721.618b4778&#64;laptopd505.fenrus.org</a>,
a new LSM is accepted into the kernel when its intent (a description of
what it tries to protect against and in what cases one would expect to
use it) has been appropriately documented in <code class="docutils literal notranslate"><span class="pre">Documentation/admin-guide/LSM/</span></code>.
This allows an LSM's code to be easily compared to its goals, and so
that end users and distros can make a more informed decision about which
LSMs suit their requirements.</p>
<p>For extensive documentation on the available LSM hook interfaces, please
see <code class="docutils literal notranslate"><span class="pre">security/security.c</span></code> and associated structures:</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_free_mnt_opts">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_free_mnt_opts</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mnt_opts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_free_mnt_opts" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free memory associated with mount options</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">**mnt_opts</span></code></dt><dd><p>LSM processed mount options</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Free memory associated with <strong>mnt_ops</strong>.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sb_eat_lsm_opts">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sb_eat_lsm_opts</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">options</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mnt_opts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sb_eat_lsm_opts" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Consume LSM mount options</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*options</span></code></dt><dd><p>mount options</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">**mnt_opts</span></code></dt><dd><p>LSM processed mount options</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Eat (scan <strong>options</strong>) and save them in <strong>mnt_opts</strong>.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, negative values on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sb_mnt_opts_compat">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sb_mnt_opts_compat</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">super_block</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sb</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mnt_opts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sb_mnt_opts_compat" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if new mount options are allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">super_block</span> <span class="pre">*sb</span></code></dt><dd><p>filesystem superblock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*mnt_opts</span></code></dt><dd><p>new mount options</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Determine if the new mount options in <strong>mnt_opts</strong> are allowed given the
existing mounted filesystem at <strong>sb</strong>.  <strong>sb</strong> superblock being compared.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if options are compatible.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sb_remount">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sb_remount</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">super_block</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sb</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mnt_opts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sb_remount" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Verify no incompatible mount changes during remount</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">super_block</span> <span class="pre">*sb</span></code></dt><dd><p>filesystem superblock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*mnt_opts</span></code></dt><dd><p>(re)mount options</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Extracts security system specific mount options and verifies no changes are
being made to those options.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sb_set_mnt_opts">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sb_set_mnt_opts</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">super_block</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sb</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mnt_opts</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n"><span class="pre">kern_flags</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">set_kern_flags</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sb_set_mnt_opts" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the mount options for a filesystem</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">super_block</span> <span class="pre">*sb</span></code></dt><dd><p>filesystem superblock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*mnt_opts</span></code></dt><dd><p>binary mount options</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">kern_flags</span></code></dt><dd><p>kernel flags (in)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">*set_kern_flags</span></code></dt><dd><p>kernel flags (out)</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Set the security relevant mount options used for a superblock.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sb_clone_mnt_opts">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sb_clone_mnt_opts</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">super_block</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">oldsb</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">super_block</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">newsb</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n"><span class="pre">kern_flags</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">set_kern_flags</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sb_clone_mnt_opts" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Duplicate superblock mount options</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">super_block</span> <span class="pre">*oldsb</span></code></dt><dd><p>source superblock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">super_block</span> <span class="pre">*newsb</span></code></dt><dd><p>destination superblock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">kern_flags</span></code></dt><dd><p>kernel flags (in)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">*set_kern_flags</span></code></dt><dd><p>kernel flags (out)</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Copy all security options from a given superblock to another.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_dentry_init_security">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_dentry_init_security</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_dentry_init_security" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">qstr</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">xattr_name</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctxlen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_dentry_init_security" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform dentry initialization</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>the dentry to initialize</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">mode</span></code></dt><dd><p>mode used to determine resource type</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">qstr</span> <span class="pre">*name</span></code></dt><dd><p>name of the last path component</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">**xattr_name</span></code></dt><dd><p>name of the security/LSM xattr</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">**ctx</span></code></dt><dd><p>pointer to the resulting LSM context</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*ctxlen</span></code></dt><dd><p>length of <strong>ctx</strong></p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Compute a context for a dentry as the inode is not yet available since NFSv4
has no label backed by an EA anyway.  It is important to note that
<strong>xattr_name</strong> does not need to be free'd by the caller, it is a static string.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, negative values on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_dentry_create_files_as">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_dentry_create_files_as</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_dentry_create_files_as" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">qstr</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cred</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">old</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cred</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">new</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_dentry_create_files_as" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform dentry initialization</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>the dentry to initialize</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">mode</span></code></dt><dd><p>mode used to determine resource type</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">qstr</span> <span class="pre">*name</span></code></dt><dd><p>name of the last path component</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">cred</span> <span class="pre">*old</span></code></dt><dd><p>creds to use for LSM context calculations</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">cred</span> <span class="pre">*new</span></code></dt><dd><p>creds to modify</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Compute a context for a dentry as the inode is not yet available and set
that context in passed in creds so that new files are created using that
context. Context is calculated using the passed in creds and not the creds
of the caller.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_init_security">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_init_security</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_init_security" title="inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">inode</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_init_security" title="inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dir</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_init_security" title="qstr"><span class="n"><span class="pre">qstr</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">qstr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_init_security" title="initxattrs"><span class="n"><span class="pre">initxattrs</span></span></a><span class="w"> </span><span class="n"><span class="pre">initxattrs</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fs_data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_init_security" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize an inode's LSM context</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*inode</span></code></dt><dd><p>the inode</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*dir</span></code></dt><dd><p>parent directory</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">qstr</span> <span class="pre">*qstr</span></code></dt><dd><p>last component of the pathname</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">initxattrs</span> <span class="pre">initxattrs</span></code></dt><dd><p>callback function to write xattrs</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*fs_data</span></code></dt><dd><p>filesystem specific data</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Obtain the security attribute name suffix and value to set on a newly
created inode and set up the incore security field for the new inode.  This
hook is called by the fs code as part of the inode creation transaction and
provides for atomic labeling of the inode, unlike the post_create/mkdir/...
hooks called by the VFS.</p>
<p>The hook function is expected to populate the xattrs array, by calling
lsm_get_xattr_slot() to retrieve the slots reserved by the security module
with the lbs_xattr_count field of the lsm_blob_sizes structure.  For each
slot, the hook function should set -&gt;name to the attribute name suffix
(e.g. selinux), to allocate -&gt;value (will be freed by the caller) and set it
to the attribute value, to set -&gt;value_len to the length of the value.  If
the security module does not use security attributes or does not wish to put
a security attribute on this particular inode, then it should return
-EOPNOTSUPP to skip this processing.</p>
<p><strong>Return</strong></p>
<dl class="simple">
<dt>Returns 0 if the LSM successfully initialized all of the inode</dt><dd><p>security attributes that are required, negative values otherwise.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_path_mknod">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_path_mknod</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">path</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dir</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_path_mknod" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="n"><span class="pre">umode_t</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">dev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_path_mknod" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if creating a special file is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">path</span> <span class="pre">*dir</span></code></dt><dd><p>parent directory</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>new file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">umode_t</span> <span class="pre">mode</span></code></dt><dd><p>new file mode</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">dev</span></code></dt><dd><p>device number</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions when creating a file. Note that this hook is called even
if mknod operation is being done for a regular file.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_path_mkdir">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_path_mkdir</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">path</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dir</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_path_mkdir" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="n"><span class="pre">umode_t</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_path_mkdir" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if creating a new directory is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">path</span> <span class="pre">*dir</span></code></dt><dd><p>parent directory</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>new directory</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">umode_t</span> <span class="pre">mode</span></code></dt><dd><p>new directory mode</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions to create a new directory in the existing directory.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_path_unlink">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_path_unlink</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">path</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dir</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_path_unlink" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_path_unlink" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if removing a hard link is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">path</span> <span class="pre">*dir</span></code></dt><dd><p>parent directory</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>file</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check the permission to remove a hard link to a file.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_path_rename">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_path_rename</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">path</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">old_dir</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">dentry</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">old_dentry</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">path</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">new_dir</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">dentry</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">new_dentry</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_path_rename" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if renaming a file is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">path</span> <span class="pre">*old_dir</span></code></dt><dd><p>parent directory of the old file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*old_dentry</span></code></dt><dd><p>the old file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">path</span> <span class="pre">*new_dir</span></code></dt><dd><p>parent directory of the new file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*new_dentry</span></code></dt><dd><p>the new file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">flags</span></code></dt><dd><p>flags</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check for permission to rename a file or directory.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_create">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_create</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">inode</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dir</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_create" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="n"><span class="pre">umode_t</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_create" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if creating a file is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*dir</span></code></dt><dd><p>the parent directory</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>the file being created</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">umode_t</span> <span class="pre">mode</span></code></dt><dd><p>requested file mode</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permission to create a regular file.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_mkdir">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_mkdir</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">inode</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dir</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_mkdir" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="n"><span class="pre">umode_t</span></span><span class="w"> </span><span class="n"><span class="pre">mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_mkdir" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if creation a new director is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*dir</span></code></dt><dd><p>parent directory</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>new directory</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">umode_t</span> <span class="pre">mode</span></code></dt><dd><p>new directory mode</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions to create a new directory in the existing directory
associated with inode structure <strong>dir</strong>.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_setattr">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_setattr</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">mnt_idmap</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">idmap</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_setattr" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">iattr</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">attr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_setattr" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if setting file attributes is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">mnt_idmap</span> <span class="pre">*idmap</span></code></dt><dd><p>idmap of the mount</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">iattr</span> <span class="pre">*attr</span></code></dt><dd><p>new attributes</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permission before setting file attributes.  Note that the kernel call
to notify_change is performed from several locations, whenever file
attributes change (such as when a file is truncated, chown/chmod operations,
transferring disk quotas, etc).</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_listsecurity">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_listsecurity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_listsecurity" title="inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">inode</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">buffer_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_listsecurity" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>List the xattr security label names</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*inode</span></code></dt><dd><p>inode</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*buffer</span></code></dt><dd><p>buffer</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">buffer_size</span></code></dt><dd><p>size of buffer</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Copy the extended attribute names for the security labels associated with
<strong>inode</strong> into <strong>buffer</strong>.  The maximum size of <strong>buffer</strong> is specified by
<strong>buffer_size</strong>.  <strong>buffer</strong> may be NULL to request the size of the buffer
required.</p>
<p><strong>Return</strong></p>
<p>Returns number of bytes used/required on success.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_copy_up">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_copy_up</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">dentry</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">src</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cred</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">new</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_copy_up" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create new creds for an overlayfs copy-up op</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*src</span></code></dt><dd><p>union dentry of copy-up file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">cred</span> <span class="pre">**new</span></code></dt><dd><p>newly created creds</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>A file is about to be copied up from lower layer to upper layer of overlay
filesystem. Security module can prepare a set of new creds and modify as
need be and return new creds. Caller will switch to new creds temporarily to
create new file and release newly allocated creds.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success or a negative error code on error.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_copy_up_xattr">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_copy_up_xattr</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_copy_up_xattr" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Filter xattrs in an overlayfs copy-up op</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*name</span></code></dt><dd><p>xattr name</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Filter the xattrs being copied up when a unioned file is copied up from a
lower layer to the union/overlay layer.   The caller is responsible for
reading and writing the xattrs, this hook is merely a filter.</p>
<p><strong>Return</strong></p>
<dl class="simple">
<dt>Returns 0 to accept the xattr, 1 to discard the xattr, -EOPNOTSUPP</dt><dd><p>if the security module does not know about attribute, or a negative
error code to abort the copy up.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_file_ioctl">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_file_ioctl</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_file_ioctl" title="file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">file</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">cmd</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n"><span class="pre">arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_file_ioctl" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if an ioctl is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">file</span> <span class="pre">*file</span></code></dt><dd><p>associated file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">cmd</span></code></dt><dd><p>ioctl cmd</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">arg</span></code></dt><dd><p>ioctl arguments</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permission for an ioctl operation on <strong>file</strong>.  Note that <strong>arg</strong> sometimes
represents a user space pointer; in other cases, it may be a simple integer
value.  When <strong>arg</strong> represents a user space pointer, it should never be used
by the security module.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_cred_getsecid">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_cred_getsecid</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">cred</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">c</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">secid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_cred_getsecid" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the secid from a set of credentials</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">cred</span> <span class="pre">*c</span></code></dt><dd><p>credentials</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*secid</span></code></dt><dd><p>secid value</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Retrieve the security identifier of the cred structure <strong>c</strong>.  In case of
failure, <strong>secid</strong> will be set to zero.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_kernel_read_file">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_kernel_read_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_kernel_read_file" title="file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">file</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">kernel_read_file_id</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n"><span class="pre">contents</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_kernel_read_file" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read a file specified by userspace</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">file</span> <span class="pre">*file</span></code></dt><dd><p>file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kernel_read_file_id</span> <span class="pre">id</span></code></dt><dd><p>file identifier</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">bool</span> <span class="pre">contents</span></code></dt><dd><p>trust if <a class="reference internal" href="#c.security_kernel_post_read_file" title="security_kernel_post_read_file"><code class="xref c c-func docutils literal notranslate"><span class="pre">security_kernel_post_read_file()</span></code></a> will be called</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Read a file specified by userspace.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_kernel_post_read_file">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_kernel_post_read_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_kernel_post_read_file" title="file"><span class="n"><span class="pre">file</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">file</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buf</span></span>, <span class="n"><span class="pre">loff_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">kernel_read_file_id</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_kernel_post_read_file" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read a file specified by userspace</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">file</span> <span class="pre">*file</span></code></dt><dd><p>file</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*buf</span></code></dt><dd><p>file contents</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">loff_t</span> <span class="pre">size</span></code></dt><dd><p>size of file contents</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kernel_read_file_id</span> <span class="pre">id</span></code></dt><dd><p>file identifier</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Read a file specified by userspace.  This must be paired with a prior call
to <a class="reference internal" href="#c.security_kernel_read_file" title="security_kernel_read_file"><code class="xref c c-func docutils literal notranslate"><span class="pre">security_kernel_read_file()</span></code></a> call that indicated this hook would also be
called, see <a class="reference internal" href="#c.security_kernel_read_file" title="security_kernel_read_file"><code class="xref c c-func docutils literal notranslate"><span class="pre">security_kernel_read_file()</span></code></a> for more information.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_kernel_load_data">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_kernel_load_data</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">kernel_load_data_id</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n"><span class="pre">contents</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_kernel_load_data" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Load data provided by userspace</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kernel_load_data_id</span> <span class="pre">id</span></code></dt><dd><p>data identifier</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">bool</span> <span class="pre">contents</span></code></dt><dd><p>true if <a class="reference internal" href="#c.security_kernel_post_load_data" title="security_kernel_post_load_data"><code class="xref c c-func docutils literal notranslate"><span class="pre">security_kernel_post_load_data()</span></code></a> will be called</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Load data provided by userspace.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_kernel_post_load_data">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_kernel_post_load_data</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buf</span></span>, <span class="n"><span class="pre">loff_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">kernel_load_data_id</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">description</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_kernel_post_load_data" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Load userspace data from a non-file source</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*buf</span></code></dt><dd><p>data</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">loff_t</span> <span class="pre">size</span></code></dt><dd><p>size of data</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kernel_load_data_id</span> <span class="pre">id</span></code></dt><dd><p>data identifier</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*description</span></code></dt><dd><p>text description of data, specific to the id value</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Load data provided by a non-file source (usually userspace buffer).  This
must be paired with a prior <a class="reference internal" href="#c.security_kernel_load_data" title="security_kernel_load_data"><code class="xref c c-func docutils literal notranslate"><span class="pre">security_kernel_load_data()</span></code></a> call that indicated
this hook would also be called, see <a class="reference internal" href="#c.security_kernel_load_data" title="security_kernel_load_data"><code class="xref c c-func docutils literal notranslate"><span class="pre">security_kernel_load_data()</span></code></a> for more
information.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_current_getsecid_subj">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_current_getsecid_subj</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">secid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_current_getsecid_subj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the current task's subjective secid</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*secid</span></code></dt><dd><p>secid value</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Retrieve the subjective security identifier of the current task and return
it in <strong>secid</strong>.  In case of failure, <strong>secid</strong> will be set to zero.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_task_getsecid_obj">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_task_getsecid_obj</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">task_struct</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">p</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">secid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_task_getsecid_obj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get a task's objective secid</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">task_struct</span> <span class="pre">*p</span></code></dt><dd><p>target task</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*secid</span></code></dt><dd><p>secid value</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Retrieve the objective security identifier of the task_struct in <strong>p</strong> and
return it in <strong>secid</strong>. In case of failure, <strong>secid</strong> will be set to zero.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_d_instantiate">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_d_instantiate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_d_instantiate" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_d_instantiate" title="inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">inode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_d_instantiate" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Populate an inode's LSM state based on a dentry</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>dentry</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*inode</span></code></dt><dd><p>inode</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Fill in <strong>inode</strong> security information for a <strong>dentry</strong> if allowed.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_ismaclabel">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_ismaclabel</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_ismaclabel" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check is the named attribute is a MAC label</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*name</span></code></dt><dd><p>full extended attribute name</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check if the extended attribute specified by <strong>name</strong> represents a MAC label.</p>
<p><strong>Return</strong></p>
<p>Returns 1 if name is a MAC attribute otherwise returns 0.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_secid_to_secctx">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_secid_to_secctx</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">secid</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">secdata</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">seclen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_secid_to_secctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convert a secid to a secctx</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">secid</span></code></dt><dd><p>secid</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">**secdata</span></code></dt><dd><p>secctx</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*seclen</span></code></dt><dd><p>secctx length</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Convert secid to security context.  If <strong>secdata</strong> is NULL the length of the
result will be returned in <strong>seclen</strong>, but no <strong>secdata</strong> will be returned.  This
does mean that the length could change between calls to check the length and
the next call which actually allocates and returns the <strong>secdata</strong>.</p>
<p><strong>Return</strong></p>
<p>Return 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_secctx_to_secid">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_secctx_to_secid</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">secdata</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">seclen</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">secid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_secctx_to_secid" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Convert a secctx to a secid</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*secdata</span></code></dt><dd><p>secctx</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">seclen</span></code></dt><dd><p>length of secctx</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*secid</span></code></dt><dd><p>secid</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Convert security context to secid.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_release_secctx">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_release_secctx</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">secdata</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">seclen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_release_secctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free a secctx buffer</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*secdata</span></code></dt><dd><p>secctx</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">seclen</span></code></dt><dd><p>length of secctx</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Release the security context.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_invalidate_secctx">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_invalidate_secctx</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_invalidate_secctx" title="inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">inode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_invalidate_secctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Invalidate an inode's security label</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*inode</span></code></dt><dd><p>inode</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Notify the security module that it must revalidate the security context of
an inode.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_notifysecctx">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_notifysecctx</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_notifysecctx" title="inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">inode</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">ctxlen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_notifysecctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Notify the LSM of an inode's security label</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*inode</span></code></dt><dd><p>inode</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*ctx</span></code></dt><dd><p>secctx</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">ctxlen</span></code></dt><dd><p>length of secctx</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Notify the security module of what the security context of an inode should
be.  Initializes the incore security context managed by the security module
for this inode.  Example usage: NFS client invokes this hook to initialize
the security context in its incore inode to the value provided by the server
for the file when the server returned the file's attributes to the client.
Must be called with inode-&gt;i_mutex locked.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_setsecctx">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_setsecctx</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_setsecctx" title="dentry"><span class="n"><span class="pre">dentry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dentry</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">ctxlen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_setsecctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Change the security label of an inode</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dentry</span> <span class="pre">*dentry</span></code></dt><dd><p>inode</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*ctx</span></code></dt><dd><p>secctx</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">ctxlen</span></code></dt><dd><p>length of secctx</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Change the security context of an inode.  Updates the incore security
context managed by the security module and invokes the fs code as needed
(via __vfs_setxattr_noperm) to update any backing xattrs that represent the
context.  Example usage: NFS server invokes this hook to change the security
context in its incore inode and on the backing filesystem to a value
provided by the client on a SETATTR operation.  Must be called with
inode-&gt;i_mutex locked.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inode_getsecctx">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inode_getsecctx</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_inode_getsecctx" title="inode"><span class="n"><span class="pre">inode</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">inode</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctxlen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inode_getsecctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the security label of an inode</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">inode</span> <span class="pre">*inode</span></code></dt><dd><p>inode</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">**ctx</span></code></dt><dd><p>secctx</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*ctxlen</span></code></dt><dd><p>length of secctx</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>On success, returns 0 and fills out <strong>ctx</strong> and <strong>ctxlen</strong> with the security
context for the given <strong>inode</strong>.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_unix_stream_connect">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_unix_stream_connect</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_unix_stream_connect" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sock</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_unix_stream_connect" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.security_unix_stream_connect" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">newsk</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_unix_stream_connect" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if a AF_UNIX stream is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sock</span></code></dt><dd><p>originating sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*other</span></code></dt><dd><p>peer sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*newsk</span></code></dt><dd><p>new sock</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions before establishing a Unix domain stream connection
between <strong>sock</strong> and <strong>other</strong>.</p>
<p>The <strong>unix_stream_connect</strong> and <strong>unix_may_send</strong> hooks were necessary because
Linux provides an alternative to the conventional file name space for Unix
domain sockets.  Whereas binding and connecting to sockets in the file name
space is mediated by the typical file permissions (and caught by the mknod
and permission hooks in inode_security_ops), binding and connecting to
sockets in the abstract name space is completely unmediated.  Sufficient
control of Unix domain sockets in the abstract name space isn't possible
using only the socket layer hooks, since we need to know the actual target
socket, which is not looked up until we are inside the af_unix code.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_unix_may_send">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_unix_may_send</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.socket" title="socket"><span class="n"><span class="pre">socket</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sock</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.socket" title="socket"><span class="n"><span class="pre">socket</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_unix_may_send" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if AF_UNIX socket can send datagrams</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">socket</span> <span class="pre">*sock</span></code></dt><dd><p>originating sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">socket</span> <span class="pre">*other</span></code></dt><dd><p>peer sock</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions before connecting or sending datagrams from <strong>sock</strong> to
<strong>other</strong>.</p>
<p>The <strong>unix_stream_connect</strong> and <strong>unix_may_send</strong> hooks were necessary because
Linux provides an alternative to the conventional file name space for Unix
domain sockets.  Whereas binding and connecting to sockets in the file name
space is mediated by the typical file permissions (and caught by the mknod
and permission hooks in inode_security_ops), binding and connecting to
sockets in the abstract name space is completely unmediated.  Sufficient
control of Unix domain sockets in the abstract name space isn't possible
using only the socket layer hooks, since we need to know the actual target
socket, which is not looked up until we are inside the af_unix code.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_socket_socketpair">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_socket_socketpair</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.socket" title="socket"><span class="n"><span class="pre">socket</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">socka</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.socket" title="socket"><span class="n"><span class="pre">socket</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sockb</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_socket_socketpair" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if creating a socketpair is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">socket</span> <span class="pre">*socka</span></code></dt><dd><p>first socket</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">socket</span> <span class="pre">*sockb</span></code></dt><dd><p>second socket</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions before creating a fresh pair of sockets.</p>
<p><strong>Return</strong></p>
<dl class="simple">
<dt>Returns 0 if permission is granted and the connection was</dt><dd><p>established.</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sock_rcv_skb">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sock_rcv_skb</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sk_buff" title="sk_buff"><span class="n"><span class="pre">sk_buff</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">skb</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sock_rcv_skb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if an incoming network packet is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>destination sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sk_buff</span> <span class="pre">*skb</span></code></dt><dd><p>incoming packet</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions on incoming network packets.  This hook is distinct from
Netfilter's IP input hooks since it is the first time that the incoming
sk_buff <strong>skb</strong> has been associated with a particular socket, <strong>sk</strong>.  Must not
sleep inside this hook because some callers hold spinlocks.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_socket_getpeersec_dgram">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_socket_getpeersec_dgram</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.socket" title="socket"><span class="n"><span class="pre">socket</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sock</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sk_buff" title="sk_buff"><span class="n"><span class="pre">sk_buff</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">skb</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">secid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_socket_getpeersec_dgram" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the remote peer label</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">socket</span> <span class="pre">*sock</span></code></dt><dd><p>socket</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sk_buff</span> <span class="pre">*skb</span></code></dt><dd><p>datagram packet</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">*secid</span></code></dt><dd><p>remote peer label secid</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This hook allows the security module to provide peer socket security state
for udp sockets on a per-packet basis to userspace via getsockopt
SO_GETPEERSEC. The application must first have indicated the IP_PASSSEC
option via getsockopt. It can then retrieve the security state returned by
this hook for a packet via the SCM_SECURITY ancillary message type.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sk_clone">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sk_clone</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">newsk</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sk_clone" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Clone a sock's LSM state</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>original sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*newsk</span></code></dt><dd><p>target sock</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Clone/copy security structure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sk_classify_flow">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sk_classify_flow</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">flowi_common</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flic</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sk_classify_flow" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set a flow's secid based on socket</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>original socket</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">flowi_common</span> <span class="pre">*flic</span></code></dt><dd><p>target flow</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Set the target flow's secid to socket's secid.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_req_classify_flow">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_req_classify_flow</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">request_sock</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">req</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">flowi_common</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flic</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_req_classify_flow" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set a flow's secid based on request_sock</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">request_sock</span> <span class="pre">*req</span></code></dt><dd><p>request_sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">flowi_common</span> <span class="pre">*flic</span></code></dt><dd><p>target flow</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Sets <strong>flic</strong>'s secid to <strong>req</strong>'s secid.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sock_graft">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sock_graft</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.socket" title="socket"><span class="n"><span class="pre">socket</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parent</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sock_graft" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reconcile LSM state when grafting a sock on a socket</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>sock being grafted</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">socket</span> <span class="pre">*parent</span></code></dt><dd><p>target parent socket</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Sets <strong>parent</strong>'s inode secid to <strong>sk</strong>'s secid and update <strong>sk</strong> with any necessary
LSM state from <strong>parent</strong>.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inet_conn_request">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inet_conn_request</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sk_buff" title="sk_buff"><span class="n"><span class="pre">sk_buff</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">skb</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">request_sock</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">req</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inet_conn_request" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set request_sock state using incoming connect</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>parent listening sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sk_buff</span> <span class="pre">*skb</span></code></dt><dd><p>incoming connection</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">request_sock</span> <span class="pre">*req</span></code></dt><dd><p>new request_sock</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Initialize the <strong>req</strong> LSM state based on <strong>sk</strong> and the incoming connect in <strong>skb</strong>.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_inet_conn_established">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_inet_conn_established</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sk_buff" title="sk_buff"><span class="n"><span class="pre">sk_buff</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">skb</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_inet_conn_established" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Update sock's LSM state with connection</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sk_buff</span> <span class="pre">*skb</span></code></dt><dd><p>connection packet</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Update <strong>sock</strong>'s LSM state to represent a new connection from <strong>skb</strong>.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_secmark_relabel_packet">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_secmark_relabel_packet</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">secid</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_secmark_relabel_packet" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if setting a secmark is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">secid</span></code></dt><dd><p>new secmark value</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check if the process should be allowed to relabel packets to <strong>secid</strong>.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_secmark_refcount_inc">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_secmark_refcount_inc</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_secmark_refcount_inc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Increment the secmark labeling rule count</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span></code></dt><dd><p>no arguments</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Tells the LSM to increment the number of secmark labeling rules loaded.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_secmark_refcount_dec">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_secmark_refcount_dec</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_secmark_refcount_dec" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Decrement the secmark labeling rule count</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span></code></dt><dd><p>no arguments</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Tells the LSM to decrement the number of secmark labeling rules loaded.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_tun_dev_alloc_security">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_tun_dev_alloc_security</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">security</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_tun_dev_alloc_security" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate a LSM blob for a TUN device</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">**security</span></code></dt><dd><p>pointer to the LSM blob</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This hook allows a module to allocate a security structure for a TUN device,
returning the pointer in <strong>security</strong>.</p>
<p><strong>Return</strong></p>
<p>Returns a zero on success, negative values on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_tun_dev_free_security">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_tun_dev_free_security</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">security</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_tun_dev_free_security" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free a TUN device LSM blob</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*security</span></code></dt><dd><p>LSM blob</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This hook allows a module to free the security structure for a TUN device.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_tun_dev_create">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_tun_dev_create</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_tun_dev_create" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if creating a TUN device is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span></code></dt><dd><p>no arguments</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions prior to creating a new TUN device.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_tun_dev_attach_queue">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_tun_dev_attach_queue</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">security</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_tun_dev_attach_queue" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if attaching a TUN queue is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*security</span></code></dt><dd><p>TUN device LSM blob</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions prior to attaching to a TUN device queue.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_tun_dev_attach">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_tun_dev_attach</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">security</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_tun_dev_attach" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Update TUN device LSM state on attach</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>associated sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*security</span></code></dt><dd><p>TUN device LSM blob</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This hook can be used by the module to update any security state associated
with the TUN device's sock structure.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_tun_dev_open">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_tun_dev_open</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">security</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_tun_dev_open" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Update TUN device LSM state on open</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*security</span></code></dt><dd><p>TUN device LSM blob</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This hook can be used by the module to update any security state associated
with the TUN device's security structure.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sctp_assoc_request">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sctp_assoc_request</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">sctp_association</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">asoc</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sk_buff" title="sk_buff"><span class="n"><span class="pre">sk_buff</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">skb</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sctp_assoc_request" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Update the LSM on a SCTP association req</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sctp_association</span> <span class="pre">*asoc</span></code></dt><dd><p>SCTP association</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sk_buff</span> <span class="pre">*skb</span></code></dt><dd><p>packet requesting the association</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Passes the <strong>asoc</strong> and <strong>chunk-&gt;skb</strong> of the association INIT packet to the LSM.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sctp_bind_connect">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sctp_bind_connect</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">optname</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">sockaddr</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">address</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">addrlen</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sctp_bind_connect" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Validate a list of addrs for a SCTP option</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>socket</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">optname</span></code></dt><dd><p>SCTP option to validate</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sockaddr</span> <span class="pre">*address</span></code></dt><dd><p>list of IP addresses to validate</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">addrlen</span></code></dt><dd><p>length of the address list</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Validiate permissions required for each address associated with sock <strong>sk</strong>.
Depending on <strong>optname</strong>, the addresses will be treated as either a connect or
bind service. The <strong>addrlen</strong> is calculated on each IPv4 and IPv6 address using
sizeof(struct sockaddr_in) or sizeof(struct sockaddr_in6).</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, error on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sctp_sk_clone">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sctp_sk_clone</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">sctp_association</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">asoc</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sk</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sock" title="sock"><span class="n"><span class="pre">sock</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">newsk</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sctp_sk_clone" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Clone a SCTP sock's LSM state</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sctp_association</span> <span class="pre">*asoc</span></code></dt><dd><p>SCTP association</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*sk</span></code></dt><dd><p>original sock</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sock</span> <span class="pre">*newsk</span></code></dt><dd><p>target sock</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Called whenever a new socket is created by accept(2) (i.e. a TCP style
socket) or when a socket is 'peeled off' e.g userspace calls
sctp_peeloff(3).</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_sctp_assoc_established">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_sctp_assoc_established</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">sctp_association</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">asoc</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../networking/kapi.html#c.sk_buff" title="sk_buff"><span class="n"><span class="pre">sk_buff</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">skb</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_sctp_assoc_established" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Update LSM state when assoc established</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sctp_association</span> <span class="pre">*asoc</span></code></dt><dd><p>SCTP association</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sk_buff</span> <span class="pre">*skb</span></code></dt><dd><p>packet establishing the association</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Passes the <strong>asoc</strong> and <strong>chunk-&gt;skb</strong> of the association COOKIE_ACK packet to the
security module.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_ib_pkey_access">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_ib_pkey_access</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sec</span></span>, <span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="n"><span class="pre">subnet_prefix</span></span>, <span class="n"><span class="pre">u16</span></span><span class="w"> </span><span class="n"><span class="pre">pkey</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_ib_pkey_access" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if access to an IB pkey is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*sec</span></code></dt><dd><p>LSM blob</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u64</span> <span class="pre">subnet_prefix</span></code></dt><dd><p>subnet prefix of the port</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u16</span> <span class="pre">pkey</span></code></dt><dd><p>IB pkey</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permission to access a pkey when modifying a QP.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_ib_endport_manage_subnet">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_ib_endport_manage_subnet</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sec</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev_name</span></span>, <span class="n"><span class="pre">u8</span></span><span class="w"> </span><span class="n"><span class="pre">port_num</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_ib_endport_manage_subnet" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if SMPs traffic is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*sec</span></code></dt><dd><p>LSM blob</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*dev_name</span></code></dt><dd><p>IB device name</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u8</span> <span class="pre">port_num</span></code></dt><dd><p>port number</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Check permissions to send and receive SMPs on a end port.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_ib_alloc_security">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_ib_alloc_security</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sec</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_ib_alloc_security" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate an Infiniband LSM blob</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">**sec</span></code></dt><dd><p>LSM blob</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Allocate a security structure for Infiniband objects.</p>
<p><strong>Return</strong></p>
<p>Returns 0 on success, non-zero on failure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_ib_free_security">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_ib_free_security</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sec</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_ib_free_security" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free an Infiniband LSM blob</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*sec</span></code></dt><dd><p>LSM blob</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Deallocate an Infiniband security structure.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_xfrm_policy_alloc">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_xfrm_policy_alloc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xfrm_sec_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctxp</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xfrm_user_sec_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sec_ctx</span></span>, <span class="n"><span class="pre">gfp_t</span></span><span class="w"> </span><span class="n"><span class="pre">gfp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_xfrm_policy_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate a xfrm policy LSM blob</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xfrm_sec_ctx</span> <span class="pre">**ctxp</span></code></dt><dd><p>xfrm security context being added to the SPD</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xfrm_user_sec_ctx</span> <span class="pre">*sec_ctx</span></code></dt><dd><p>security label provided by userspace</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">gfp_t</span> <span class="pre">gfp</span></code></dt><dd><p>gfp flags</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Allocate a security structure to the xp-&gt;security field; the security field
is initialized to NULL when the xfrm_policy is allocated.</p>
<p><strong>Return</strong></p>
<p>Return 0 if operation was successful.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_xfrm_policy_free">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_xfrm_policy_free</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xfrm_sec_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_xfrm_policy_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free a xfrm security context</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xfrm_sec_ctx</span> <span class="pre">*ctx</span></code></dt><dd><p>xfrm security context</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Free LSM resources associated with <strong>ctx</strong>.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_xfrm_state_alloc">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_xfrm_state_alloc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xfrm_state</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xfrm_user_sec_ctx</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sec_ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_xfrm_state_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate a xfrm state LSM blob</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xfrm_state</span> <span class="pre">*x</span></code></dt><dd><p>xfrm state being added to the SAD</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xfrm_user_sec_ctx</span> <span class="pre">*sec_ctx</span></code></dt><dd><p>security label provided by userspace</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Allocate a security structure to the <strong>x-&gt;security</strong> field; the security field
is initialized to NULL when the xfrm_state is allocated. Set the context to
correspond to <strong>sec_ctx</strong>.</p>
<p><strong>Return</strong></p>
<p>Return 0 if operation was successful.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_xfrm_state_delete">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_xfrm_state_delete</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xfrm_state</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_xfrm_state_delete" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if deleting a xfrm state is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xfrm_state</span> <span class="pre">*x</span></code></dt><dd><p>xfrm state</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Authorize deletion of x-&gt;security.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.security_locked_down">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">security_locked_down</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">lockdown_reason</span></span><span class="w"> </span><span class="n"><span class="pre">what</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.security_locked_down" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check if a kernel feature is allowed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">lockdown_reason</span> <span class="pre">what</span></code></dt><dd><p>requested kernel feature</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Determine whether a kernel feature that potentially enables arbitrary code
execution in kernel space should be permitted.</p>
<p><strong>Return</strong></p>
<p>Returns 0 if permission is granted.</p>
</div>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;The kernel development community.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/security/lsm-development.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>